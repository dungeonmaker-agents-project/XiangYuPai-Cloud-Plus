# ==========================================
# Eve的MySQL配置 - 聊天模块优化
# ==========================================

[mysqld]
# ========== 基础配置 ==========
port = 3306
bind-address = 0.0.0.0
default-storage-engine = INNODB

# ========== 字符集 ==========
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
init_connect = 'SET NAMES utf8mb4'

# ========== 连接配置 ==========
max_connections = 200
max_connect_errors = 1000
wait_timeout = 28800
interactive_timeout = 28800

# ========== InnoDB配置 ==========
innodb_buffer_pool_size = 256M
innodb_log_file_size = 64M
innodb_flush_log_at_trx_commit = 1
innodb_lock_wait_timeout = 50

# ========== 查询缓存（v7.1优化）==========
# MySQL 8.0已移除查询缓存

# ========== 慢查询日志 ==========
slow_query_log = 1
long_query_time = 2
slow_query_log_file = /var/log/mysql/slow.log

# ========== 二进制日志（可选）==========
# log_bin = /var/log/mysql/mysql-bin.log
# expire_logs_days = 7
# max_binlog_size = 100M

# ========== 时区 ==========
default-time-zone = '+08:00'

# ========== 聊天模块特殊优化 ==========
# 消息表频繁INSERT优化
innodb_flush_method = O_DIRECT

# 会话列表频繁查询优化
# 已通过冗余字段优化，无需额外配置

[client]
default-character-set = utf8mb4

[mysql]
default-character-set = utf8mb4

