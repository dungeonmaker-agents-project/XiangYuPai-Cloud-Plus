# XYPai ç”¨æˆ·ç®¡ç†æ¶æ„è®¾è®¡æ–¹æ¡ˆ

## ğŸ¯ è®¾è®¡ç›®æ ‡

åŸºäºRuoYi-Cloud-Plusç°æœ‰çš„ç”¨æˆ·ç®¡ç†ä½“ç³»ï¼Œæ‰©å±•XYPaiä¸šåŠ¡ç³»ç»Ÿçš„ç”¨æˆ·åŠŸèƒ½ï¼Œé¿å…é‡å¤å¼€å‘ï¼Œé™ä½ç»´æŠ¤æˆæœ¬ã€‚

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

### âŒ æ–¹æ¡ˆ1ï¼šç‹¬ç«‹ç”¨æˆ·æ•°æ®åº“ï¼ˆä¸æ¨èï¼‰

**æ¶æ„ï¼š**
- RuoYi Systemï¼šç‹¬ç«‹çš„ç”¨æˆ·ç®¡ç†ï¼ˆç®¡ç†åå°ï¼‰
- XYPai Systemï¼šç‹¬ç«‹çš„ç”¨æˆ·æ•°æ®åº“ï¼ˆä¸šåŠ¡ç³»ç»Ÿï¼‰

**é—®é¢˜ï¼š**
1. **æ•°æ®åŒæ­¥å¤æ‚** - ä¸¤ä¸ªæ•°æ®åº“çš„ç”¨æˆ·æ•°æ®éœ€è¦å®æ—¶åŒæ­¥
2. **æƒé™ç®¡ç†é‡å¤** - éœ€è¦ç»´æŠ¤ä¸¤å¥—RBACæƒé™ä½“ç³»
3. **å¼€å‘å·¥ä½œé‡å¤§** - é‡æ–°å¼€å‘ç”¨æˆ·ç®¡ç†ã€è§’è‰²ç®¡ç†ã€æƒé™ç®¡ç†
4. **ç»´æŠ¤æˆæœ¬é«˜** - åŒå€çš„ç»´æŠ¤å·¥ä½œï¼ŒBugä¿®å¤éœ€è¦ä¸¤è¾¹åŒæ­¥
5. **TokenéªŒè¯å¤æ‚** - è·¨ç³»ç»ŸTokenéªŒè¯ï¼Œæ•°æ®ä¸€è‡´æ€§éš¾ä¿è¯

**æ—¶é—´æˆæœ¬ä¼°ç®—ï¼š**
- ç”¨æˆ·ç®¡ç†æ¨¡å—å¼€å‘ï¼š2-3å‘¨
- æƒé™ç®¡ç†æ¨¡å—å¼€å‘ï¼š2-3å‘¨
- æ•°æ®åŒæ­¥æœºåˆ¶ï¼š1-2å‘¨
- Tokené›†æˆå’Œæµ‹è¯•ï¼š1å‘¨
- **æ€»è®¡ï¼š6-9å‘¨** âŒ

---

### âœ… æ–¹æ¡ˆ2ï¼šåˆ†å±‚æ‰©å±•æ¶æ„ï¼ˆå¼ºçƒˆæ¨èï¼‰â­

**æ¶æ„ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç»Ÿä¸€ç”¨æˆ·åŸºç¡€å±‚ (RuoYi System)            â”‚
â”‚                                                       â”‚
â”‚  â€¢ sys_user (ç”¨æˆ·è¡¨)                                  â”‚
â”‚  â€¢ sys_role (è§’è‰²è¡¨)                                  â”‚
â”‚  â€¢ sys_user_role (ç”¨æˆ·è§’è‰²å…³è”)                       â”‚
â”‚  â€¢ sys_dept (éƒ¨é—¨è¡¨)                                  â”‚
â”‚  â€¢ sys_menu (èœå•æƒé™è¡¨)                              â”‚
â”‚  â€¢ sys_role_menu (è§’è‰²èœå•å…³è”)                       â”‚
â”‚                                                       â”‚
â”‚  âœ… å·²æœ‰å®Œæ•´çš„RBACæƒé™ä½“ç³»                             â”‚
â”‚  âœ… å·²æœ‰Sa-Tokené›†æˆ                                  â”‚
â”‚  âœ… å·²æœ‰ç”¨æˆ·ç®¡ç†é¡µé¢å’ŒAPI                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–²
                        â”‚ user_id (å¤–é”®å…³è”)
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ xypai_user_  â”‚ â”‚xypai_contentâ”‚  â”‚ xypai_trade_    â”‚
â”‚   profile    â”‚ â”‚  _author    â”‚  â”‚   member        â”‚
â”‚              â”‚ â”‚             â”‚  â”‚                 â”‚
â”‚ ç”¨æˆ·æ¡£æ¡ˆæ‰©å±• â”‚ â”‚ åˆ›ä½œè€…ä¿¡æ¯  â”‚  â”‚ ä¼šå‘˜äº¤æ˜“ä¿¡æ¯    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜åŠ¿ï¼š**
1. âœ… **å¿«é€Ÿå¼€å‘** - å¤ç”¨ç°æˆçš„ç”¨æˆ·ç®¡ç†å’Œæƒé™ä½“ç³»
2. âœ… **æ•°æ®ä¸€è‡´** - ç»Ÿä¸€çš„ç”¨æˆ·åŸºç¡€æ•°æ®ï¼Œæ— éœ€åŒæ­¥
3. âœ… **ç»´æŠ¤ç®€å•** - åªç»´æŠ¤ä¸€å¥—æ ¸å¿ƒç”¨æˆ·ç³»ç»Ÿ
4. âœ… **æ‰©å±•çµæ´»** - å„ä¸šåŠ¡æ¨¡å—æŒ‰éœ€æ‰©å±•ç”¨æˆ·ä¿¡æ¯
5. âœ… **Tokenç»Ÿä¸€** - ä½¿ç”¨åŒä¸€å¥—Sa-TokenéªŒè¯æœºåˆ¶

**æ—¶é—´æˆæœ¬ä¼°ç®—ï¼š**
- è®¾è®¡æ‰©å±•è¡¨ç»“æ„ï¼š1å¤©
- åˆ›å»ºæ‰©å±•Serviceå’ŒAPIï¼š3-5å¤©
- å‰ç«¯é¡µé¢å¼€å‘ï¼š5-7å¤©
- è”è°ƒæµ‹è¯•ï¼š2-3å¤©
- **æ€»è®¡ï¼š2-3å‘¨** âœ…

**èŠ‚çœæ—¶é—´ï¼š4-6å‘¨ï¼**

---

## ğŸ—ï¸ æ¨èæ–¹æ¡ˆè¯¦ç»†è®¾è®¡

### 1. æ•°æ®åº“è®¾è®¡

#### 1.1 åŸºç¡€ç”¨æˆ·è¡¨ï¼ˆå¤ç”¨ç°æœ‰ï¼‰

```sql
-- å¤ç”¨ RuoYi çš„ sys_user è¡¨
-- ä¸éœ€è¦ä¿®æ”¹ï¼Œç›´æ¥ä½¿ç”¨
-- åŒ…å«ï¼šuser_id, user_name, nick_name, email, phone, sex, avatar, passwordç­‰
```

#### 1.2 XYPaiç”¨æˆ·æ¡£æ¡ˆæ‰©å±•è¡¨ï¼ˆæ–°å»ºï¼‰

```sql
-- xypai-user æ¨¡å—
CREATE TABLE xypai_user_profile (
    profile_id      BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT 'æ¡£æ¡ˆID',
    user_id         BIGINT NOT NULL UNIQUE COMMENT 'ç”¨æˆ·IDï¼ˆå…³è”sys_userï¼‰',
    
    -- ç¤¾äº¤ä¿¡æ¯
    nickname        VARCHAR(50) COMMENT 'æ˜µç§°',
    bio             TEXT COMMENT 'ä¸ªäººç®€ä»‹',
    gender          CHAR(1) COMMENT 'æ€§åˆ«(0-æœªçŸ¥,1-ç”·,2-å¥³)',
    birthday        DATE COMMENT 'ç”Ÿæ—¥',
    location        VARCHAR(100) COMMENT 'æ‰€åœ¨åœ°',
    
    -- ç¤¾äº¤ç»Ÿè®¡
    followers_count INT DEFAULT 0 COMMENT 'ç²‰ä¸æ•°',
    following_count INT DEFAULT 0 COMMENT 'å…³æ³¨æ•°',
    
    -- ç”¨æˆ·ç­‰çº§å’Œç§¯åˆ†
    level           INT DEFAULT 1 COMMENT 'ç”¨æˆ·ç­‰çº§',
    experience      INT DEFAULT 0 COMMENT 'ç»éªŒå€¼',
    points          INT DEFAULT 0 COMMENT 'ç§¯åˆ†',
    
    -- è®¤è¯ä¿¡æ¯
    is_verified     CHAR(1) DEFAULT '0' COMMENT 'æ˜¯å¦è®¤è¯(0-å¦,1-æ˜¯)',
    verify_type     VARCHAR(20) COMMENT 'è®¤è¯ç±»å‹(personal-ä¸ªäºº,enterprise-ä¼ä¸š)',
    verify_time     DATETIME COMMENT 'è®¤è¯æ—¶é—´',
    
    -- åå¥½è®¾ç½®
    preferences     JSON COMMENT 'ç”¨æˆ·åå¥½è®¾ç½®',
    
    -- å®¡è®¡å­—æ®µ
    create_time     DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time     DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES sys_user(user_id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_level (level)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='XYPaiç”¨æˆ·æ¡£æ¡ˆæ‰©å±•è¡¨';
```

#### 1.3 XYPaiåˆ›ä½œè€…ä¿¡æ¯è¡¨ï¼ˆæ–°å»ºï¼‰

```sql
-- xypai-content æ¨¡å—
CREATE TABLE xypai_content_author (
    author_id       BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT 'åˆ›ä½œè€…ID',
    user_id         BIGINT NOT NULL UNIQUE COMMENT 'ç”¨æˆ·IDï¼ˆå…³è”sys_userï¼‰',
    
    -- åˆ›ä½œè€…ä¿¡æ¯
    author_name     VARCHAR(50) NOT NULL COMMENT 'åˆ›ä½œè€…åç§°',
    author_avatar   VARCHAR(200) COMMENT 'åˆ›ä½œè€…å¤´åƒ',
    author_intro    TEXT COMMENT 'åˆ›ä½œè€…ç®€ä»‹',
    
    -- åˆ›ä½œç»Ÿè®¡
    works_count     INT DEFAULT 0 COMMENT 'ä½œå“æ•°é‡',
    fans_count      INT DEFAULT 0 COMMENT 'ç²‰ä¸æ•°',
    likes_count     INT DEFAULT 0 COMMENT 'è·èµæ•°',
    views_count     BIGINT DEFAULT 0 COMMENT 'æ€»æµè§ˆé‡',
    
    -- åˆ›ä½œè€…çŠ¶æ€
    status          CHAR(1) DEFAULT '0' COMMENT 'çŠ¶æ€(0-æ­£å¸¸,1-ç¦ç”¨)',
    is_featured     CHAR(1) DEFAULT '0' COMMENT 'æ˜¯å¦æ¨èåˆ›ä½œè€…',
    
    -- å®¡è®¡å­—æ®µ
    create_time     DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time     DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES sys_user(user_id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='XYPaiåˆ›ä½œè€…ä¿¡æ¯è¡¨';
```

#### 1.4 XYPaiä¼šå‘˜ä¿¡æ¯è¡¨ï¼ˆæ–°å»ºï¼‰

```sql
-- xypai-trade æ¨¡å—
CREATE TABLE xypai_trade_member (
    member_id       BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT 'ä¼šå‘˜ID',
    user_id         BIGINT NOT NULL UNIQUE COMMENT 'ç”¨æˆ·IDï¼ˆå…³è”sys_userï¼‰',
    
    -- ä¼šå‘˜ä¿¡æ¯
    member_level    VARCHAR(20) DEFAULT 'FREE' COMMENT 'ä¼šå‘˜ç­‰çº§(FREE-å…è´¹,VIP-ä¼šå‘˜,SVIP-è¶…çº§ä¼šå‘˜)',
    expire_time     DATETIME COMMENT 'ä¼šå‘˜åˆ°æœŸæ—¶é—´',
    
    -- ç§¯åˆ†å’Œä½™é¢
    points          INT DEFAULT 0 COMMENT 'ç§¯åˆ†',
    balance         DECIMAL(10,2) DEFAULT 0.00 COMMENT 'ä½™é¢',
    
    -- äº¤æ˜“ç»Ÿè®¡
    total_orders    INT DEFAULT 0 COMMENT 'æ€»è®¢å•æ•°',
    total_amount    DECIMAL(10,2) DEFAULT 0.00 COMMENT 'æ€»æ¶ˆè´¹é‡‘é¢',
    
    -- å®¡è®¡å­—æ®µ
    create_time     DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time     DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES sys_user(user_id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_member_level (member_level)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='XYPaiä¼šå‘˜ä¿¡æ¯è¡¨';
```

---

### 2. åç«¯Serviceè®¾è®¡

#### 2.1 ç”¨æˆ·æ¡£æ¡ˆService

```java
// xypai-user æ¨¡å—
package com.xypai.user.service;

import com.xypai.user.domain.XypaiUserProfile;
import com.xypai.user.domain.vo.UserProfileVO;
import org.dromara.system.domain.SysUser;

public interface IXypaiUserProfileService {
    
    /**
     * è·å–ç”¨æˆ·å®Œæ•´ä¿¡æ¯ï¼ˆåŸºç¡€ä¿¡æ¯ + æ¡£æ¡ˆä¿¡æ¯ï¼‰
     */
    UserProfileVO getUserProfile(Long userId);
    
    /**
     * åˆ›å»ºç”¨æˆ·æ¡£æ¡ˆï¼ˆç”¨æˆ·æ³¨å†Œæ—¶è‡ªåŠ¨åˆ›å»ºï¼‰
     */
    void createProfile(Long userId);
    
    /**
     * æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆ
     */
    boolean updateProfile(XypaiUserProfile profile);
    
    /**
     * æ›´æ–°ç”¨æˆ·ç­‰çº§
     */
    boolean updateLevel(Long userId, Integer level);
    
    /**
     * å¢åŠ ç§¯åˆ†
     */
    boolean addPoints(Long userId, Integer points);
}
```

```java
// å®ç°ç±»
@Service
public class XypaiUserProfileServiceImpl implements IXypaiUserProfileService {
    
    @Autowired
    private XypaiUserProfileMapper profileMapper;
    
    @Autowired
    private ISysUserService sysUserService;  // å¤ç”¨RuoYiçš„ç”¨æˆ·Service
    
    @Override
    public UserProfileVO getUserProfile(Long userId) {
        // 1. è·å–åŸºç¡€ç”¨æˆ·ä¿¡æ¯ï¼ˆfrom sys_userï¼‰
        SysUser sysUser = sysUserService.selectUserById(userId);
        
        // 2. è·å–æ‰©å±•æ¡£æ¡ˆä¿¡æ¯ï¼ˆfrom xypai_user_profileï¼‰
        XypaiUserProfile profile = profileMapper.selectByUserId(userId);
        
        // 3. ç»„åˆè¿”å›
        UserProfileVO vo = new UserProfileVO();
        vo.setUserId(sysUser.getUserId());
        vo.setUsername(sysUser.getUserName());
        vo.setNickName(sysUser.getNickName());
        vo.setEmail(sysUser.getEmail());
        vo.setPhone(sysUser.getPhone());
        vo.setAvatar(sysUser.getAvatar());
        
        if (profile != null) {
            vo.setBio(profile.getBio());
            vo.setLevel(profile.getLevel());
            vo.setPoints(profile.getPoints());
            vo.setFollowersCount(profile.getFollowersCount());
            vo.setFollowingCount(profile.getFollowingCount());
        }
        
        return vo;
    }
    
    @Override
    @Transactional
    public void createProfile(Long userId) {
        XypaiUserProfile profile = new XypaiUserProfile();
        profile.setUserId(userId);
        profile.setLevel(1);
        profile.setPoints(0);
        profileMapper.insert(profile);
    }
    
    // ... å…¶ä»–æ–¹æ³•å®ç°
}
```

#### 2.2 ç”¨æˆ·æ³¨å†Œç›‘å¬å™¨ï¼ˆè‡ªåŠ¨åˆ›å»ºæ‰©å±•ä¿¡æ¯ï¼‰

```java
package com.xypai.user.listener;

import com.xypai.user.service.IXypaiUserProfileService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.event.EventListener;
import org.springframework.stereotype.Component;

/**
 * ç”¨æˆ·æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨
 * å½“RuoYi Systemåˆ›å»ºæ–°ç”¨æˆ·æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºXYPaiæ‰©å±•ä¿¡æ¯
 */
@Component
public class UserRegistrationListener {
    
    @Autowired
    private IXypaiUserProfileService profileService;
    
    @EventListener
    public void onUserCreated(UserCreatedEvent event) {
        Long userId = event.getUserId();
        
        // è‡ªåŠ¨åˆ›å»ºç”¨æˆ·æ¡£æ¡ˆ
        profileService.createProfile(userId);
        
        // å¯ä»¥æ·»åŠ å…¶ä»–åˆå§‹åŒ–é€»è¾‘
        // ä¾‹å¦‚ï¼šèµ é€æ–°äººç§¯åˆ†ã€åˆ›å»ºé»˜è®¤è®¾ç½®ç­‰
    }
}
```

---

### 3. å‰ç«¯é¡µé¢è®¾è®¡

#### 3.1 å¤ç”¨ç®¡ç†åå°ï¼ˆæ¨èï¼‰

```
ç°æœ‰RuoYiç®¡ç†åå°
â”œâ”€â”€ ç³»ç»Ÿç®¡ç†
â”‚   â”œâ”€â”€ ç”¨æˆ·ç®¡ç†  â† ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦æ”¹åŠ¨
â”‚   â”œâ”€â”€ è§’è‰²ç®¡ç†  â† ç›´æ¥ä½¿ç”¨
â”‚   â”œâ”€â”€ èœå•ç®¡ç†  â† ç›´æ¥ä½¿ç”¨
â”‚   â””â”€â”€ éƒ¨é—¨ç®¡ç†  â† ç›´æ¥ä½¿ç”¨
â”‚
æ–°å¢XYPaiä¸šåŠ¡èœå•
â”œâ”€â”€ ç”¨æˆ·ä¸­å¿ƒ
â”‚   â”œâ”€â”€ ç”¨æˆ·æ¡£æ¡ˆç®¡ç†  â† æ–°å¼€å‘ï¼ˆæ‰©å±•ä¿¡æ¯ï¼‰
â”‚   â”œâ”€â”€ åˆ›ä½œè€…ç®¡ç†    â† æ–°å¼€å‘
â”‚   â””â”€â”€ ä¼šå‘˜ç®¡ç†      â† æ–°å¼€å‘
â”œâ”€â”€ å†…å®¹ç®¡ç†
â”‚   â””â”€â”€ ...
â””â”€â”€ äº¤æ˜“ç®¡ç†
    â””â”€â”€ ...
```

**ä¼˜åŠ¿ï¼š**
- âœ… åŸºç¡€ç”¨æˆ·CRUDæ“ä½œç›´æ¥ç”¨ç°æˆçš„
- âœ… è§’è‰²æƒé™ç®¡ç†ç›´æ¥ç”¨ç°æˆçš„
- âœ… åªéœ€å¼€å‘ä¸šåŠ¡ç‰¹æœ‰çš„æ‰©å±•åŠŸèƒ½

#### 3.2 ç”¨æˆ·æ¡£æ¡ˆé¡µé¢ç¤ºä¾‹

```vue
<!-- views/xypai/user/profile/index.vue -->
<template>
  <div class="app-container">
    <el-tabs v-model="activeTab">
      <!-- Tab1: åŸºç¡€ä¿¡æ¯ï¼ˆå¯é€‰æ‹©æ€§æ˜¾ç¤ºï¼‰ -->
      <el-tab-pane label="åŸºç¡€ä¿¡æ¯" name="basic">
        <el-descriptions :column="2" border>
          <el-descriptions-item label="ç”¨æˆ·å">{{ profile.username }}</el-descriptions-item>
          <el-descriptions-item label="æ˜µç§°">{{ profile.nickName }}</el-descriptions-item>
          <el-descriptions-item label="é‚®ç®±">{{ profile.email }}</el-descriptions-item>
          <el-descriptions-item label="æ‰‹æœºå·">{{ profile.phone }}</el-descriptions-item>
        </el-descriptions>
        
        <el-button @click="editBasicInfo">ç¼–è¾‘åŸºç¡€ä¿¡æ¯</el-button>
        <!-- ç‚¹å‡»åè·³è½¬åˆ° /system/user é¡µé¢ -->
      </el-tab-pane>
      
      <!-- Tab2: æ¡£æ¡ˆä¿¡æ¯ï¼ˆæ‰©å±•å­—æ®µï¼‰ -->
      <el-tab-pane label="æ¡£æ¡ˆä¿¡æ¯" name="profile">
        <el-form :model="profile" label-width="100px">
          <el-form-item label="ä¸ªäººç®€ä»‹">
            <el-input type="textarea" v-model="profile.bio" />
          </el-form-item>
          
          <el-form-item label="ç”¨æˆ·ç­‰çº§">
            <el-rate v-model="profile.level" disabled />
            <span>ç­‰çº§ {{ profile.level }}</span>
          </el-form-item>
          
          <el-form-item label="ç§¯åˆ†">
            <el-input-number v-model="profile.points" disabled />
          </el-form-item>
          
          <el-form-item label="ç²‰ä¸æ•°">
            {{ profile.followersCount }}
          </el-form-item>
          
          <el-form-item label="å…³æ³¨æ•°">
            {{ profile.followingCount }}
          </el-form-item>
        </el-form>
        
        <el-button type="primary" @click="updateProfile">ä¿å­˜æ¡£æ¡ˆ</el-button>
      </el-tab-pane>
      
      <!-- Tab3: è®¤è¯ä¿¡æ¯ -->
      <el-tab-pane label="è®¤è¯ä¿¡æ¯" name="verify">
        <!-- è®¤è¯ç›¸å…³åŠŸèƒ½ -->
      </el-tab-pane>
    </el-tabs>
  </div>
</template>

<script>
export default {
  data() {
    return {
      activeTab: 'basic',
      profile: {}
    }
  },
  methods: {
    // è·å–å®Œæ•´ç”¨æˆ·ä¿¡æ¯
    async getUserProfile() {
      const userId = this.$route.params.userId;
      const res = await this.$axios.get(`/xypai-user/profile/${userId}`);
      this.profile = res.data;
    },
    
    // ç¼–è¾‘åŸºç¡€ä¿¡æ¯ï¼ˆè·³è½¬åˆ°ç³»ç»Ÿç®¡ç†çš„ç”¨æˆ·ç¼–è¾‘é¡µé¢ï¼‰
    editBasicInfo() {
      this.$router.push(`/system/user/edit/${this.profile.userId}`);
    },
    
    // æ›´æ–°æ¡£æ¡ˆä¿¡æ¯
    async updateProfile() {
      await this.$axios.put('/xypai-user/profile', this.profile);
      this.$message.success('æ¡£æ¡ˆæ›´æ–°æˆåŠŸ');
    }
  }
}
</script>
```

---

### 4. APIæ¥å£è®¾è®¡

#### 4.1 XYPaiç”¨æˆ·æ¡£æ¡ˆAPI

```java
@RestController
@RequestMapping("/xypai-user/profile")
public class XypaiUserProfileController {
    
    @Autowired
    private IXypaiUserProfileService profileService;
    
    /**
     * è·å–ç”¨æˆ·å®Œæ•´æ¡£æ¡ˆ
     */
    @GetMapping("/{userId}")
    public R<UserProfileVO> getProfile(@PathVariable Long userId) {
        UserProfileVO profile = profileService.getUserProfile(userId);
        return R.ok(profile);
    }
    
    /**
     * è·å–å½“å‰ç™»å½•ç”¨æˆ·æ¡£æ¡ˆ
     */
    @GetMapping("/me")
    public R<UserProfileVO> getMyProfile() {
        Long userId = LoginHelper.getUserId();
        UserProfileVO profile = profileService.getUserProfile(userId);
        return R.ok(profile);
    }
    
    /**
     * æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆ
     */
    @PutMapping
    public R<Void> updateProfile(@RequestBody XypaiUserProfile profile) {
        Long userId = LoginHelper.getUserId();
        profile.setUserId(userId);
        profileService.updateProfile(profile);
        return R.ok();
    }
    
    /**
     * å¢åŠ ç”¨æˆ·ç§¯åˆ†
     */
    @PostMapping("/points/add")
    public R<Void> addPoints(@RequestParam Integer points) {
        Long userId = LoginHelper.getUserId();
        profileService.addPoints(userId, points);
        return R.ok();
    }
}
```

---

### 5. ç™»å½•å’Œæƒé™å¤„ç†

#### 5.1 ç»Ÿä¸€ç™»å½•å…¥å£ï¼ˆæ¨èï¼‰

```
æ–¹æ¡ˆï¼šä½¿ç”¨åŒä¸€ä¸ªç™»å½•æ¥å£ï¼Œæ ¹æ®clientIdåŒºåˆ†å‰åå°
```

```java
// å·²æœ‰çš„ç™»å½•æ¥å£ï¼Œæ— éœ€ä¿®æ”¹
POST /auth/login

{
    "username": "admin",
    "password": "admin123",
    "clientId": "e5cd7e4891bf95d1d19206ce24a7b32e",  // PCç«¯ï¼ˆç®¡ç†åå°ï¼‰
    // æˆ–
    "clientId": "app-client-id",  // APPç«¯ï¼ˆä¸šåŠ¡å‰å°ï¼‰
}

// è¿”å›çš„Tokenå¯ä»¥è®¿é—®æ‰€æœ‰å¾®æœåŠ¡
// æƒé™é€šè¿‡è§’è‰²æ§åˆ¶
```

#### 5.2 å‰åå°æƒé™åŒºåˆ†

```java
// é€šè¿‡è§’è‰²æ¥åŒºåˆ†å‰åå°æƒé™

// åå°ç®¡ç†è§’è‰²
sys_role:
- admin (è¶…çº§ç®¡ç†å‘˜) - æ‰€æœ‰æƒé™
- manager (ç®¡ç†å‘˜) - åå°ç®¡ç†æƒé™
- editor (ç¼–è¾‘) - å†…å®¹ç¼–è¾‘æƒé™

// å‰å°ä¸šåŠ¡è§’è‰²
sys_role:
- user (æ™®é€šç”¨æˆ·) - åŸºç¡€ä¸šåŠ¡æƒé™
- vip (ä¼šå‘˜ç”¨æˆ·) - ä¼šå‘˜æƒé™
- author (åˆ›ä½œè€…) - åˆ›ä½œæƒé™

// APIæƒé™æ§åˆ¶ç¤ºä¾‹
@PreAuthorize("hasRole('admin') or hasRole('manager')")  // åå°ç®¡ç†
@GetMapping("/system/user/list")
public R<List<SysUser>> listUsers() { ... }

@PreAuthorize("hasRole('user')")  // å‰å°ç”¨æˆ·
@GetMapping("/xypai-content/my/works")
public R<List<Content>> myWorks() { ... }
```

---

## ğŸ“‹ å®æ–½æ­¥éª¤

### é˜¶æ®µ1ï¼šæ•°æ®åº“è®¾è®¡ï¼ˆ1å¤©ï¼‰

- [ ] è®¾è®¡XYPaiç”¨æˆ·æ‰©å±•è¡¨ç»“æ„
- [ ] åˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] æ‰§è¡Œæ•°æ®åº“å˜æ›´

### é˜¶æ®µ2ï¼šåç«¯å¼€å‘ï¼ˆ1å‘¨ï¼‰

- [ ] åˆ›å»ºXYPaiç”¨æˆ·æ¡£æ¡ˆå®ä½“ç±»
- [ ] åˆ›å»ºMapperæ¥å£
- [ ] å®ç°Serviceå±‚
- [ ] å¼€å‘Controller API
- [ ] æ·»åŠ ç”¨æˆ·æ³¨å†Œç›‘å¬å™¨
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•

### é˜¶æ®µ3ï¼šå‰ç«¯å¼€å‘ï¼ˆ1å‘¨ï¼‰

- [ ] åˆ›å»ºç”¨æˆ·æ¡£æ¡ˆç®¡ç†é¡µé¢
- [ ] é›†æˆç°æœ‰ç”¨æˆ·ç®¡ç†é¡µé¢
- [ ] å¼€å‘æ‰©å±•ä¿¡æ¯ç¼–è¾‘åŠŸèƒ½
- [ ] æ·»åŠ èœå•å’Œè·¯ç”±
- [ ] å‰åç«¯è”è°ƒ

### é˜¶æ®µ4ï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ3-5å¤©ï¼‰

- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] å®‰å…¨æµ‹è¯•
- [ ] Bugä¿®å¤
- [ ] æ–‡æ¡£ç¼–å†™

**æ€»æ—¶é—´ï¼š2-3å‘¨**

---

## âš ï¸ ä¸æ¨èç‹¬ç«‹æ•°æ®åº“çš„åŸå› 

### å¦‚æœä½¿ç”¨ç‹¬ç«‹æ•°æ®åº“ï¼Œæ‚¨éœ€è¦è§£å†³ï¼š

1. **ç”¨æˆ·æ•°æ®åŒæ­¥**
   ```java
   // éœ€è¦å®ç°å¤æ‚çš„æ•°æ®åŒæ­¥æœºåˆ¶
   @Scheduled(fixedRate = 60000)  // æ¯åˆ†é’ŸåŒæ­¥
   public void syncUsers() {
       // ä»RuoYiåº“åŒæ­¥åˆ°XYPaiåº“
       // å¤„ç†æ•°æ®å†²çª
       // å¤„ç†å¢é‡æ›´æ–°
   }
   ```

2. **Tokenè·¨åº“éªŒè¯**
   ```java
   // Tokenåœ¨RuoYiåº“éªŒè¯ï¼Œä½†ç”¨æˆ·æ•°æ®åœ¨XYPaiåº“
   // éœ€è¦å¤æ‚çš„è·¨åº“æŸ¥è¯¢å’ŒéªŒè¯é€»è¾‘
   ```

3. **æƒé™ç®¡ç†é‡å¤**
   ```java
   // éœ€è¦åœ¨XYPaiåº“ä¸­é‡æ–°å®ç°è§’è‰²ã€èœå•ã€æƒé™ç®¡ç†
   // ä¸RuoYiçš„æƒé™ä½“ç³»éœ€è¦ä¿æŒä¸€è‡´
   ```

4. **æ•°æ®ä¸€è‡´æ€§é—®é¢˜**
   ```
   åœºæ™¯ï¼šç”¨æˆ·åœ¨ç®¡ç†åå°è¢«ç¦ç”¨
   é—®é¢˜ï¼šå¦‚ä½•åŒæ­¥åˆ°XYPaiæ•°æ®åº“ï¼Ÿ
   é—®é¢˜ï¼šå¦‚æœåŒæ­¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
   é—®é¢˜ï¼šå¦‚ä½•ä¿è¯å®æ—¶æ€§ï¼Ÿ
   ```

**è¿™äº›é—®é¢˜ä¼šæ¶ˆè€—å¤§é‡å¼€å‘å’Œç»´æŠ¤æ—¶é—´ï¼**

---

## ğŸ¯ æ€»ç»“å»ºè®®

### âœ… å¼ºçƒˆæ¨èï¼šåˆ†å±‚æ‰©å±•æ¶æ„

1. **å¤ç”¨RuoYiçš„ç”¨æˆ·ç®¡ç†ä½“ç³»**
   - sys_user ä½œä¸ºç»Ÿä¸€ç”¨æˆ·åŸºç¡€è¡¨
   - sys_roleã€sys_menu ç®¡ç†æƒé™
   - Sa-Token ç»Ÿä¸€è®¤è¯

2. **å„ä¸šåŠ¡æ¨¡å—æŒ‰éœ€æ‰©å±•**
   - xypai_user_profileï¼ˆç”¨æˆ·æ¡£æ¡ˆï¼‰
   - xypai_content_authorï¼ˆåˆ›ä½œè€…ä¿¡æ¯ï¼‰
   - xypai_trade_memberï¼ˆä¼šå‘˜ä¿¡æ¯ï¼‰

3. **ç»Ÿä¸€ç™»å½•ï¼Œè§’è‰²åŒºåˆ†æƒé™**
   - ä¸€ä¸ªç™»å½•æ¥å£
   - é€šè¿‡è§’è‰²åŒºåˆ†å‰åå°
   - Tokenå¯è®¿é—®æ‰€æœ‰æœåŠ¡

### æ—¶é—´å’Œæˆæœ¬å¯¹æ¯”

| æ–¹æ¡ˆ | å¼€å‘æ—¶é—´ | ç»´æŠ¤æˆæœ¬ | æ¨èæŒ‡æ•° |
|------|----------|----------|----------|
| **åˆ†å±‚æ‰©å±•** | 2-3å‘¨ | ä½ | â­â­â­â­â­ |
| **ç‹¬ç«‹æ•°æ®åº“** | 6-9å‘¨ | é«˜ | â­ |

**èŠ‚çœæ—¶é—´ï¼š4-6å‘¨**  
**èŠ‚çœæˆæœ¬ï¼š60-70%**

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

å»ºè®®æ‚¨ï¼š

1. **é‡‡ç”¨åˆ†å±‚æ‰©å±•æ¶æ„**
2. **å…ˆè®¾è®¡æ•°æ®åº“è¡¨ç»“æ„**ï¼ˆå‚è€ƒä¸Šé¢çš„SQLï¼‰
3. **ä»ä¸€ä¸ªæ¨¡å—å¼€å§‹**ï¼ˆå»ºè®®ä»xypai-userå¼€å§‹ï¼‰
4. **é€æ­¥æ‰©å±•å…¶ä»–æ¨¡å—**

å¦‚éœ€å¸®åŠ©ï¼Œæˆ‘å¯ä»¥ï¼š
- ç”Ÿæˆå®Œæ•´çš„æ•°æ®åº“DDLè„šæœ¬
- æä¾›Service/Controllerå®Œæ•´ä»£ç 
- æä¾›å‰ç«¯é¡µé¢ç¤ºä¾‹ä»£ç 
- æä¾›ç”¨æˆ·æ³¨å†Œ/ç™»å½•å®Œæ•´æµç¨‹ä»£ç 

---

**æœ€åæ›´æ–°ï¼š2025-11-10**

