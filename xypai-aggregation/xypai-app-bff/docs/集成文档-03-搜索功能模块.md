# é›†æˆæ–‡æ¡£ 03: æœç´¢åŠŸèƒ½æ¨¡å— (Page06-07)

> ç‰ˆæœ¬: v1.0.0 | åˆ›å»ºæ—¥æœŸ: 2025-11-26 | ä¼˜å…ˆçº§: â­â­â­ (ä¸­)

---

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

### ä¸šåŠ¡æè¿°
æœç´¢åŠŸèƒ½æ˜¯å‘å¨±æ‹å¹³å°çš„æ ¸å¿ƒå‘ç°åŠŸèƒ½ï¼Œæ”¯æŒç”¨æˆ·æœç´¢é™ªç»ƒç”¨æˆ·ã€æœåŠ¡è®¢å•ã€è¯é¢˜ç­‰å†…å®¹ã€‚åŒ…æ‹¬æœç´¢åˆå§‹åŒ–ï¼ˆå†å²/çƒ­æœï¼‰ã€æœç´¢è”æƒ³ã€ç»¼åˆæœç´¢ç»“æœå››ä¸ªTabã€‚

### å¯¹åº”å‰ç«¯é¡µé¢
| é¡µé¢ | è·¯ç”± | åŠŸèƒ½ |
|------|------|------|
| Page06 | `/search` | æœç´¢é¡µï¼ˆå†å²/çƒ­æœ/è”æƒ³ï¼‰ |
| Page07 | `/search/results` | æœç´¢ç»“æœï¼ˆ4ä¸ªTabï¼‰ |

### å½“å‰çŠ¶æ€
- **BFF å±‚**: âœ… Mock å®ç°å®Œæˆ
- **RPC æ¥å£**: â³ å¾…å®šä¹‰
- **é¢†åŸŸæœåŠ¡**: â³ å¾…å®ç°
- **Elasticsearch**: ğŸ”® å¯é€‰æ¥å…¥

---

## ğŸ¯ é›†æˆç›®æ ‡

å°† `HomeSearchServiceImpl` å’Œ `HomeSearchResultServiceImpl` ä¸­çš„ Mock æ•°æ®æ›¿æ¢ä¸ºçœŸå®çš„ Dubbo RPC è°ƒç”¨ï¼Œéœ€è¦è°ƒç”¨ `xypai-user` å’Œ `xypai-content` ä¸¤ä¸ªæœåŠ¡ã€‚

---

## ğŸ“ æ¶‰åŠæ–‡ä»¶æ¸…å•

### BFF å±‚ (xypai-app-bff)

| æ–‡ä»¶è·¯å¾„ | ç±»å‹ | è¯´æ˜ | é›†æˆæ—¶ä¿®æ”¹ |
|----------|------|------|-----------|
| `controller/HomeSearchController.java` | Controller | æœç´¢åˆå§‹åŒ–æ¥å£ | âŒ æ— éœ€ä¿®æ”¹ |
| `controller/SearchResultController.java` | Controller | æœç´¢ç»“æœæ¥å£ (5ä¸ª) | âŒ æ— éœ€ä¿®æ”¹ |
| `service/HomeSearchService.java` | Interface | æœç´¢åˆå§‹åŒ–æœåŠ¡ | âŒ æ— éœ€ä¿®æ”¹ |
| `service/HomeSearchResultService.java` | Interface | æœç´¢ç»“æœæœåŠ¡ | âŒ æ— éœ€ä¿®æ”¹ |
| `service/impl/HomeSearchServiceImpl.java` | Impl | æœç´¢åˆå§‹åŒ–å®ç° | âœ… **æ ¸å¿ƒä¿®æ”¹** |
| `service/impl/HomeSearchResultServiceImpl.java` | Impl | æœç´¢ç»“æœå®ç° | âœ… **æ ¸å¿ƒä¿®æ”¹** |
| `domain/dto/SearchSuggestQueryDTO.java` | DTO | è”æƒ³æŸ¥è¯¢ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/dto/SearchHistoryDeleteDTO.java` | DTO | å†å²åˆ é™¤ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/dto/SearchQueryDTO.java` | DTO | æœç´¢æŸ¥è¯¢ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/vo/SearchInitVO.java` | VO | åˆå§‹åŒ–ç»“æœ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/vo/SearchSuggestVO.java` | VO | è”æƒ³ç»“æœ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/vo/SearchResultVO.java` | VO | ç»¼åˆæœç´¢ç»“æœ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/vo/SearchAllResultVO.java` | VO | å…¨éƒ¨Tabç»“æœ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/vo/SearchUserResultVO.java` | VO | ç”¨æˆ·Tabç»“æœ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/vo/SearchOrderResultVO.java` | VO | ä¸‹å•Tabç»“æœ | âŒ æ— éœ€ä¿®æ”¹ |
| `domain/vo/SearchTopicResultVO.java` | VO | è¯é¢˜Tabç»“æœ | âŒ æ— éœ€ä¿®æ”¹ |

### RPC API å±‚

#### xypai-api-appuser (æ‰©å±•)

| æ–‡ä»¶è·¯å¾„ | ç±»å‹ | è¯´æ˜ | æ“ä½œ |
|----------|------|------|------|
| `RemoteAppUserService.java` | Interface | RPC æ¥å£ | âœ… **æ–°å¢4ä¸ªæ–¹æ³•** |
| `domain/dto/UserSearchDto.java` | DTO | ç”¨æˆ·æœç´¢è¯·æ±‚ | âœ… **æ–°å»º** |
| `domain/vo/UserSearchVo.java` | VO | ç”¨æˆ·æœç´¢ç»“æœ | âœ… **æ–°å»º** |
| `domain/vo/UserSearchPageResult.java` | VO | ç”¨æˆ·æœç´¢åˆ†é¡µ | âœ… **æ–°å»º** |
| `domain/vo/HotSearchVo.java` | VO | çƒ­é—¨æœç´¢ | âœ… **æ–°å»º** |
| `domain/vo/SearchSuggestVo.java` | VO | æœç´¢è”æƒ³ | âœ… **æ–°å»º** |

#### xypai-api-content (æ–°å»ºæˆ–æ‰©å±•)

| æ–‡ä»¶è·¯å¾„ | ç±»å‹ | è¯´æ˜ | æ“ä½œ |
|----------|------|------|------|
| `RemoteContentSearchService.java` | Interface | å†…å®¹æœç´¢æ¥å£ | âœ… **æ–°å»º** |
| `domain/dto/ContentSearchDto.java` | DTO | å†…å®¹æœç´¢è¯·æ±‚ | âœ… **æ–°å»º** |
| `domain/vo/FeedSearchVo.java` | VO | åŠ¨æ€æœç´¢ç»“æœ | âœ… **æ–°å»º** |
| `domain/vo/FeedSearchPageResult.java` | VO | åŠ¨æ€æœç´¢åˆ†é¡µ | âœ… **æ–°å»º** |
| `domain/vo/TopicSearchVo.java` | VO | è¯é¢˜æœç´¢ç»“æœ | âœ… **æ–°å»º** |
| `domain/vo/TopicSearchPageResult.java` | VO | è¯é¢˜æœç´¢åˆ†é¡µ | âœ… **æ–°å»º** |

### é¢†åŸŸæœåŠ¡å±‚

#### xypai-user

| æ–‡ä»¶è·¯å¾„ | ç±»å‹ | è¯´æ˜ | æ“ä½œ |
|----------|------|------|------|
| `service/impl/RemoteAppUserServiceImpl.java` | Impl | æ‰©å±•æœç´¢æ–¹æ³• | âœ… **æ–°å¢4ä¸ªæ–¹æ³•** |
| `service/UserSearchService.java` | Service | ç”¨æˆ·æœç´¢æœåŠ¡ | âœ… **æ–°å»ºï¼ˆå¯é€‰ï¼‰** |
| `mapper/SearchHistoryMapper.java` | Mapper | æœç´¢å†å² | âœ… **æ–°å»º** |

#### xypai-content

| æ–‡ä»¶è·¯å¾„ | ç±»å‹ | è¯´æ˜ | æ“ä½œ |
|----------|------|------|------|
| `service/impl/RemoteContentSearchServiceImpl.java` | Impl | å†…å®¹æœç´¢å®ç° | âœ… **æ–°å»º** |
| `service/FeedSearchService.java` | Service | åŠ¨æ€æœç´¢æœåŠ¡ | âœ… **æ–°å»º** |
| `service/TopicSearchService.java` | Service | è¯é¢˜æœç´¢æœåŠ¡ | âœ… **æ–°å»º** |

---

## ğŸ—„ï¸ Step 1: æ•°æ®åº“è®¾è®¡

### 1.1 æœç´¢å†å²è¡¨ (search_history)

```sql
CREATE TABLE `search_history` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
    `user_id` BIGINT NOT NULL COMMENT 'ç”¨æˆ·ID',
    `keyword` VARCHAR(100) NOT NULL COMMENT 'æœç´¢å…³é”®è¯',
    `search_type` VARCHAR(20) DEFAULT 'all' COMMENT 'æœç´¢ç±»å‹: all, user, order, topic',
    `search_count` INT DEFAULT 1 COMMENT 'æœç´¢æ¬¡æ•°',
    `last_search_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'æœ€è¿‘æœç´¢æ—¶é—´',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    `del_flag` TINYINT(1) DEFAULT 0 COMMENT 'åˆ é™¤æ ‡è®°',

    PRIMARY KEY (`id`),
    UNIQUE INDEX `uk_user_keyword` (`user_id`, `keyword`),
    INDEX `idx_user_id` (`user_id`),
    INDEX `idx_last_search_time` (`last_search_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æœç´¢å†å²è¡¨';
```

### 1.2 çƒ­é—¨æœç´¢é…ç½®è¡¨ (hot_search_config)

```sql
CREATE TABLE `hot_search_config` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
    `keyword` VARCHAR(100) NOT NULL COMMENT 'çƒ­æœå…³é”®è¯',
    `display_text` VARCHAR(100) COMMENT 'æ˜¾ç¤ºæ–‡æœ¬ï¼ˆå¯å¸¦æ ‡ç­¾å¦‚"çƒ­"ï¼‰',
    `icon` VARCHAR(50) COMMENT 'å›¾æ ‡: hot, new, rise',
    `sort_order` INT DEFAULT 0 COMMENT 'æ’åºå·',
    `is_active` TINYINT(1) DEFAULT 1 COMMENT 'æ˜¯å¦å¯ç”¨',
    `expire_time` DATETIME COMMENT 'è¿‡æœŸæ—¶é—´',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',

    PRIMARY KEY (`id`),
    INDEX `idx_is_active` (`is_active`),
    INDEX `idx_sort_order` (`sort_order`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='çƒ­é—¨æœç´¢é…ç½®è¡¨';

-- åˆå§‹æ•°æ®
INSERT INTO `hot_search_config` (`keyword`, `display_text`, `icon`, `sort_order`) VALUES
('ç‹è€…è£è€€', 'ç‹è€…è£è€€', 'hot', 1),
('æ°¸åŠ«æ— é—´', 'æ°¸åŠ«æ— é—´', 'hot', 2),
('LOL', 'LOL', 'new', 3),
('å’Œå¹³ç²¾è‹±', 'å’Œå¹³ç²¾è‹±', NULL, 4),
('åŸç¥', 'åŸç¥', 'rise', 5);
```

### 1.3 è¯é¢˜è¡¨ (topic) - xypai_content æ•°æ®åº“

```sql
CREATE TABLE `topic` (
    `topic_id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'è¯é¢˜ID',
    `topic_name` VARCHAR(100) NOT NULL COMMENT 'è¯é¢˜åç§°',
    `description` VARCHAR(500) COMMENT 'è¯é¢˜æè¿°',
    `cover_image` VARCHAR(500) COMMENT 'å°é¢å›¾ç‰‡',
    `feed_count` INT DEFAULT 0 COMMENT 'åŠ¨æ€æ•°é‡',
    `view_count` INT DEFAULT 0 COMMENT 'æµè§ˆé‡',
    `is_hot` TINYINT(1) DEFAULT 0 COMMENT 'æ˜¯å¦çƒ­é—¨',
    `is_official` TINYINT(1) DEFAULT 0 COMMENT 'æ˜¯å¦å®˜æ–¹è¯é¢˜',
    `status` TINYINT(1) DEFAULT 1 COMMENT 'çŠ¶æ€: 0ç¦ç”¨, 1å¯ç”¨',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    `del_flag` TINYINT(1) DEFAULT 0 COMMENT 'åˆ é™¤æ ‡è®°',

    PRIMARY KEY (`topic_id`),
    INDEX `idx_topic_name` (`topic_name`),
    INDEX `idx_is_hot` (`is_hot`),
    FULLTEXT INDEX `ft_topic_name` (`topic_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='è¯é¢˜è¡¨';
```

---

## ğŸ”§ Step 2: RPC æ¥å£å®šä¹‰

### 2.1 æ‰©å±• RemoteAppUserService

**æ–‡ä»¶**: `ruoyi-api/xypai-api-appuser/src/main/java/org/dromara/appuser/api/RemoteAppUserService.java`

```java
// åœ¨ç°æœ‰æ¥å£ä¸­æ–°å¢ä»¥ä¸‹æ–¹æ³•:

/**
 * è·å–çƒ­é—¨æœç´¢å…³é”®è¯
 *
 * @param limit æ•°é‡é™åˆ¶
 * @return çƒ­é—¨æœç´¢åˆ—è¡¨
 */
List<HotSearchVo> getHotSearchKeywords(Integer limit);

/**
 * è·å–ç”¨æˆ·æœç´¢å†å²
 *
 * @param userId ç”¨æˆ·ID
 * @param limit æ•°é‡é™åˆ¶
 * @return æœç´¢å†å²åˆ—è¡¨
 */
List<String> getUserSearchHistory(Long userId, Integer limit);

/**
 * ä¿å­˜æœç´¢å†å²
 *
 * @param userId ç”¨æˆ·ID
 * @param keyword æœç´¢å…³é”®è¯
 * @param searchType æœç´¢ç±»å‹
 */
void saveSearchHistory(Long userId, String keyword, String searchType);

/**
 * åˆ é™¤æœç´¢å†å²
 *
 * @param userId ç”¨æˆ·ID
 * @param keyword å…³é”®è¯ï¼ˆnullè¡¨ç¤ºæ¸…ç©ºæ‰€æœ‰ï¼‰
 * @return æ˜¯å¦æˆåŠŸ
 */
Boolean deleteSearchHistory(Long userId, String keyword);

/**
 * è·å–æœç´¢è”æƒ³
 *
 * @param keyword å…³é”®è¯
 * @param limit æ•°é‡é™åˆ¶
 * @return è”æƒ³ç»“æœ
 */
SearchSuggestVo getSearchSuggestions(String keyword, Integer limit);

/**
 * æœç´¢ç”¨æˆ·
 *
 * @param searchDto æœç´¢æ¡ä»¶
 * @return ç”¨æˆ·æœç´¢ç»“æœ
 */
UserSearchPageResult searchUsers(UserSearchDto searchDto);

/**
 * æœç´¢æœåŠ¡æä¾›è€…ï¼ˆä¸‹å•Tabï¼‰
 *
 * @param searchDto æœç´¢æ¡ä»¶
 * @return æœåŠ¡æä¾›è€…æœç´¢ç»“æœ
 */
UserSearchPageResult searchServiceProviders(UserSearchDto searchDto);
```

### 2.2 æ–°å¢ DTO/VO ç±»

**æ–‡ä»¶**: `ruoyi-api/xypai-api-appuser/src/main/java/org/dromara/appuser/api/domain/dto/UserSearchDto.java`

```java
package org.dromara.appuser.api.domain.dto;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;

/**
 * ç”¨æˆ·æœç´¢ DTO
 */
@Data
public class UserSearchDto implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    /** æœç´¢å…³é”®è¯ */
    private String keyword;

    /** é¡µç  */
    private Integer pageNum = 1;

    /** æ¯é¡µæ•°é‡ */
    private Integer pageSize = 10;

    /** æ€§åˆ«ç­›é€‰ */
    private String gender;

    /** åŸå¸‚ä»£ç  */
    private String cityCode;

    /** åŒºåŸŸä»£ç  */
    private String districtCode;

    /** æ’åºæ–¹å¼ */
    private String sortBy;

    /** å½“å‰ç”¨æˆ·ID (ç”¨äºè®¡ç®—æ˜¯å¦å…³æ³¨) */
    private Long currentUserId;

    /** æ˜¯å¦åªæœç´¢æœåŠ¡æä¾›è€… */
    private Boolean onlyProviders = false;
}
```

**æ–‡ä»¶**: `ruoyi-api/xypai-api-appuser/src/main/java/org/dromara/appuser/api/domain/vo/UserSearchVo.java`

```java
package org.dromara.appuser.api.domain.vo;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;
import java.math.BigDecimal;
import java.util.List;

/**
 * ç”¨æˆ·æœç´¢ç»“æœ VO
 */
@Data
public class UserSearchVo implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    private Long userId;
    private String nickname;
    private String avatar;
    private String gender;
    private Integer age;
    private Boolean isOnline;
    private Boolean isVerified;
    private String verifyType;
    private String bio;

    // å…³æ³¨çŠ¶æ€
    private Boolean isFollowed;

    // ç»Ÿè®¡
    private Integer fansCount;
    private Integer followCount;

    // æœåŠ¡æä¾›è€…ç›¸å…³ï¼ˆä¸‹å•Tabç”¨ï¼‰
    private Boolean isProvider;
    private List<String> skillTypes;
    private BigDecimal minPrice;
    private String priceDisplay;
    private BigDecimal rating;
    private Integer orderCount;
    private Integer distance;
    private List<TagVo> tags;

    @Data
    public static class TagVo implements Serializable {
        @Serial
        private static final long serialVersionUID = 1L;
        private String text;
        private String type;
    }
}
```

**æ–‡ä»¶**: `ruoyi-api/xypai-api-appuser/src/main/java/org/dromara/appuser/api/domain/vo/UserSearchPageResult.java`

```java
package org.dromara.appuser.api.domain.vo;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;
import java.util.List;

/**
 * ç”¨æˆ·æœç´¢åˆ†é¡µç»“æœ
 */
@Data
public class UserSearchPageResult implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    private List<UserSearchVo> list;
    private Long total;
    private Boolean hasMore;
}
```

**æ–‡ä»¶**: `ruoyi-api/xypai-api-appuser/src/main/java/org/dromara/appuser/api/domain/vo/HotSearchVo.java`

```java
package org.dromara.appuser.api.domain.vo;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;

/**
 * çƒ­é—¨æœç´¢ VO
 */
@Data
public class HotSearchVo implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    /** å…³é”®è¯ */
    private String keyword;

    /** æ˜¾ç¤ºæ–‡æœ¬ */
    private String displayText;

    /** å›¾æ ‡: hot, new, rise */
    private String icon;

    /** æ’åºå· */
    private Integer sortOrder;
}
```

**æ–‡ä»¶**: `ruoyi-api/xypai-api-appuser/src/main/java/org/dromara/appuser/api/domain/vo/SearchSuggestVo.java`

```java
package org.dromara.appuser.api.domain.vo;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;
import java.util.List;

/**
 * æœç´¢è”æƒ³ VO
 */
@Data
public class SearchSuggestVo implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    /** ç”¨æˆ·å»ºè®® */
    private List<UserSuggestVo> users;

    /** è¯é¢˜å»ºè®® */
    private List<TopicSuggestVo> topics;

    /** å…³é”®è¯å»ºè®® */
    private List<String> keywords;

    @Data
    public static class UserSuggestVo implements Serializable {
        @Serial
        private static final long serialVersionUID = 1L;
        private Long userId;
        private String nickname;
        private String avatar;
        private Boolean isVerified;
    }

    @Data
    public static class TopicSuggestVo implements Serializable {
        @Serial
        private static final long serialVersionUID = 1L;
        private Long topicId;
        private String topicName;
        private Integer feedCount;
    }
}
```

### 2.3 æ–°å»º RemoteContentSearchService

**æ–‡ä»¶**: `ruoyi-api/xypai-api-content/src/main/java/org/dromara/content/api/RemoteContentSearchService.java`

```java
package org.dromara.content.api;

import org.dromara.content.api.domain.dto.ContentSearchDto;
import org.dromara.content.api.domain.vo.*;

/**
 * å†…å®¹æœç´¢è¿œç¨‹æœåŠ¡æ¥å£
 */
public interface RemoteContentSearchService {

    /**
     * æœç´¢åŠ¨æ€å†…å®¹
     *
     * @param searchDto æœç´¢æ¡ä»¶
     * @return åŠ¨æ€æœç´¢ç»“æœ
     */
    FeedSearchPageResult searchFeeds(ContentSearchDto searchDto);

    /**
     * æœç´¢è¯é¢˜
     *
     * @param searchDto æœç´¢æ¡ä»¶
     * @return è¯é¢˜æœç´¢ç»“æœ
     */
    TopicSearchPageResult searchTopics(ContentSearchDto searchDto);

    /**
     * è·å–è¯é¢˜è”æƒ³
     *
     * @param keyword å…³é”®è¯
     * @param limit æ•°é‡é™åˆ¶
     * @return è¯é¢˜è”æƒ³åˆ—è¡¨
     */
    List<TopicSuggestVo> getTopicSuggestions(String keyword, Integer limit);
}
```

**æ–‡ä»¶**: `ruoyi-api/xypai-api-content/src/main/java/org/dromara/content/api/domain/dto/ContentSearchDto.java`

```java
package org.dromara.content.api.domain.dto;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;

/**
 * å†…å®¹æœç´¢ DTO
 */
@Data
public class ContentSearchDto implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    /** æœç´¢å…³é”®è¯ */
    private String keyword;

    /** é¡µç  */
    private Integer pageNum = 1;

    /** æ¯é¡µæ•°é‡ */
    private Integer pageSize = 10;

    /** å†…å®¹ç±»å‹: all, post, video */
    private String contentType;

    /** æ’åºæ–¹å¼: relevance, newest, hottest */
    private String sortBy;
}
```

**æ–‡ä»¶**: `ruoyi-api/xypai-api-content/src/main/java/org/dromara/content/api/domain/vo/FeedSearchVo.java`

```java
package org.dromara.content.api.domain.vo;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;
import java.time.LocalDateTime;
import java.util.List;

/**
 * åŠ¨æ€æœç´¢ç»“æœ VO
 */
@Data
public class FeedSearchVo implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    private Long feedId;
    private String contentType;  // post, video
    private String content;
    private String summary;  // å†…å®¹æ‘˜è¦ï¼ˆé«˜äº®å…³é”®è¯ï¼‰
    private List<String> images;
    private String videoUrl;
    private String videoCover;

    // ä½œè€…
    private Long authorId;
    private String authorNickname;
    private String authorAvatar;
    private Boolean authorIsVerified;

    // ç»Ÿè®¡
    private Integer likeCount;
    private Integer commentCount;
    private Integer shareCount;

    // æ—¶é—´
    private LocalDateTime createTime;
    private String timeDisplay;
}
```

**æ–‡ä»¶**: `ruoyi-api/xypai-api-content/src/main/java/org/dromara/content/api/domain/vo/TopicSearchVo.java`

```java
package org.dromara.content.api.domain.vo;

import lombok.Data;
import java.io.Serial;
import java.io.Serializable;

/**
 * è¯é¢˜æœç´¢ç»“æœ VO
 */
@Data
public class TopicSearchVo implements Serializable {

    @Serial
    private static final long serialVersionUID = 1L;

    private Long topicId;
    private String topicName;
    private String description;
    private String coverImage;
    private Integer feedCount;
    private Integer viewCount;
    private Boolean isHot;
    private Boolean isOfficial;
    private String feedCountDisplay;  // "1.2ä¸‡æ¡åŠ¨æ€"
    private String viewCountDisplay;  // "10ä¸‡æµè§ˆ"
}
```

---

## ğŸ”§ Step 3: é¢†åŸŸæœåŠ¡å®ç°

### 3.1 xypai-user æœåŠ¡å®ç°

**æ–‡ä»¶**: `xypai-modules/xypai-user/src/main/java/org/dromara/user/service/remote/RemoteAppUserServiceImpl.java`

```java
// æ–°å¢æœç´¢ç›¸å…³æ–¹æ³•

@Override
public List<HotSearchVo> getHotSearchKeywords(Integer limit) {
    log.info("è·å–çƒ­é—¨æœç´¢: limit={}", limit);
    return hotSearchConfigMapper.selectActiveHotSearch(limit);
}

@Override
public List<String> getUserSearchHistory(Long userId, Integer limit) {
    log.info("è·å–ç”¨æˆ·æœç´¢å†å²: userId={}, limit={}", userId, limit);
    return searchHistoryMapper.selectUserHistory(userId, limit);
}

@Override
public void saveSearchHistory(Long userId, String keyword, String searchType) {
    log.info("ä¿å­˜æœç´¢å†å²: userId={}, keyword={}", userId, keyword);

    // å…ˆå°è¯•æ›´æ–°å·²å­˜åœ¨çš„è®°å½•
    int updated = searchHistoryMapper.updateSearchCount(userId, keyword);
    if (updated == 0) {
        // ä¸å­˜åœ¨åˆ™æ’å…¥æ–°è®°å½•
        SearchHistory history = new SearchHistory();
        history.setUserId(userId);
        history.setKeyword(keyword);
        history.setSearchType(searchType);
        searchHistoryMapper.insert(history);
    }
}

@Override
public Boolean deleteSearchHistory(Long userId, String keyword) {
    log.info("åˆ é™¤æœç´¢å†å²: userId={}, keyword={}", userId, keyword);

    if (keyword == null) {
        // æ¸…ç©ºæ‰€æœ‰
        return searchHistoryMapper.deleteByUserId(userId) >= 0;
    } else {
        // åˆ é™¤å•æ¡
        return searchHistoryMapper.deleteByUserAndKeyword(userId, keyword) > 0;
    }
}

@Override
public SearchSuggestVo getSearchSuggestions(String keyword, Integer limit) {
    log.info("è·å–æœç´¢è”æƒ³: keyword={}, limit={}", keyword, limit);

    SearchSuggestVo result = new SearchSuggestVo();

    // 1. ç”¨æˆ·è”æƒ³
    result.setUsers(userMapper.suggestByNickname(keyword, limit));

    // 2. å…³é”®è¯è”æƒ³ (ä»çƒ­æœã€å†å²ç­‰èšåˆ)
    result.setKeywords(hotSearchConfigMapper.suggestKeywords(keyword, limit));

    // 3. è¯é¢˜è”æƒ³ (éœ€è¦è°ƒç”¨ content æœåŠ¡)
    // å¯é€‰: ä½¿ç”¨ @DubboReference è°ƒç”¨ RemoteContentSearchService

    return result;
}

@Override
public UserSearchPageResult searchUsers(UserSearchDto searchDto) {
    log.info("æœç´¢ç”¨æˆ·: {}", searchDto);

    Page<UserSearchVo> page = userMapper.searchUsers(
        new Page<>(searchDto.getPageNum(), searchDto.getPageSize()),
        searchDto
    );

    // æ‰¹é‡æŸ¥è¯¢å…³æ³¨çŠ¶æ€
    if (searchDto.getCurrentUserId() != null) {
        List<Long> userIds = page.getRecords().stream()
            .map(UserSearchVo::getUserId)
            .collect(Collectors.toList());
        Map<Long, Boolean> followedMap = followMapper.batchCheckFollowed(
            searchDto.getCurrentUserId(), userIds
        );
        page.getRecords().forEach(vo ->
            vo.setIsFollowed(followedMap.getOrDefault(vo.getUserId(), false))
        );
    }

    UserSearchPageResult result = new UserSearchPageResult();
    result.setList(page.getRecords());
    result.setTotal(page.getTotal());
    result.setHasMore(page.hasNext());
    return result;
}

@Override
public UserSearchPageResult searchServiceProviders(UserSearchDto searchDto) {
    log.info("æœç´¢æœåŠ¡æä¾›è€…: {}", searchDto);

    searchDto.setOnlyProviders(true);
    Page<UserSearchVo> page = userMapper.searchProviders(
        new Page<>(searchDto.getPageNum(), searchDto.getPageSize()),
        searchDto
    );

    UserSearchPageResult result = new UserSearchPageResult();
    result.setList(page.getRecords());
    result.setTotal(page.getTotal());
    result.setHasMore(page.hasNext());
    return result;
}
```

### 3.2 xypai-content æœåŠ¡å®ç°

**æ–‡ä»¶**: `xypai-modules/xypai-content/src/main/java/org/dromara/content/service/remote/RemoteContentSearchServiceImpl.java`

```java
package org.dromara.content.service.remote;

import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.apache.dubbo.config.annotation.DubboService;
import org.dromara.content.api.RemoteContentSearchService;
import org.dromara.content.api.domain.dto.ContentSearchDto;
import org.dromara.content.api.domain.vo.*;
import org.dromara.content.mapper.FeedMapper;
import org.dromara.content.mapper.TopicMapper;
import org.springframework.stereotype.Service;

import java.util.List;

/**
 * å†…å®¹æœç´¢è¿œç¨‹æœåŠ¡å®ç°
 */
@Slf4j
@Service
@DubboService
@RequiredArgsConstructor
public class RemoteContentSearchServiceImpl implements RemoteContentSearchService {

    private final FeedMapper feedMapper;
    private final TopicMapper topicMapper;

    @Override
    public FeedSearchPageResult searchFeeds(ContentSearchDto searchDto) {
        log.info("æœç´¢åŠ¨æ€: {}", searchDto);

        Page<FeedSearchVo> page = feedMapper.searchFeeds(
            new Page<>(searchDto.getPageNum(), searchDto.getPageSize()),
            searchDto
        );

        FeedSearchPageResult result = new FeedSearchPageResult();
        result.setList(page.getRecords());
        result.setTotal(page.getTotal());
        result.setHasMore(page.hasNext());
        return result;
    }

    @Override
    public TopicSearchPageResult searchTopics(ContentSearchDto searchDto) {
        log.info("æœç´¢è¯é¢˜: {}", searchDto);

        Page<TopicSearchVo> page = topicMapper.searchTopics(
            new Page<>(searchDto.getPageNum(), searchDto.getPageSize()),
            searchDto
        );

        TopicSearchPageResult result = new TopicSearchPageResult();
        result.setList(page.getRecords());
        result.setTotal(page.getTotal());
        result.setHasMore(page.hasNext());
        return result;
    }

    @Override
    public List<TopicSuggestVo> getTopicSuggestions(String keyword, Integer limit) {
        log.info("è·å–è¯é¢˜è”æƒ³: keyword={}, limit={}", keyword, limit);
        return topicMapper.suggestByName(keyword, limit);
    }
}
```

---

## ğŸ”§ Step 4: BFF å±‚é›†æˆ

### 4.1 ä¿®æ”¹ HomeSearchServiceImpl

**æ–‡ä»¶**: `xypai-aggregation/xypai-app-bff/src/main/java/org/dromara/appbff/service/impl/HomeSearchServiceImpl.java`

```java
package org.dromara.appbff.service.impl;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.apache.dubbo.config.annotation.DubboReference;
import org.dromara.appbff.domain.dto.SearchHistoryDeleteDTO;
import org.dromara.appbff.domain.dto.SearchSuggestQueryDTO;
import org.dromara.appbff.domain.vo.*;
import org.dromara.appbff.service.HomeSearchService;
import org.dromara.appuser.api.RemoteAppUserService;
import org.dromara.appuser.api.domain.vo.*;
import org.dromara.content.api.RemoteContentSearchService;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.stream.Collectors;

/**
 * é¦–é¡µæœç´¢æœåŠ¡å®ç°ç±»ï¼ˆRPC ç‰ˆæœ¬ï¼‰
 */
@Slf4j
@Service
@RequiredArgsConstructor
public class HomeSearchServiceImpl implements HomeSearchService {

    @DubboReference
    private RemoteAppUserService remoteAppUserService;

    @DubboReference
    private RemoteContentSearchService remoteContentSearchService;

    @Override
    public SearchInitVO getSearchInit(Long userId) {
        log.info("è·å–æœç´¢åˆå§‹æ•°æ®: userId={}", userId);

        SearchInitVO result = new SearchInitVO();

        // 1. è·å–çƒ­é—¨æœç´¢
        List<HotSearchVo> hotSearchList = remoteAppUserService.getHotSearchKeywords(10);
        result.setHotSearchList(convertToHotSearchItems(hotSearchList));

        // 2. è·å–ç”¨æˆ·æœç´¢å†å²
        if (userId != null) {
            List<String> historyList = remoteAppUserService.getUserSearchHistory(userId, 10);
            result.setHistoryList(historyList);
        }

        // 3. æœç´¢æ¡†å ä½ç¬¦
        result.setPlaceholder("æœç´¢ç”¨æˆ·ã€è¯é¢˜ã€æœåŠ¡");

        return result;
    }

    @Override
    public SearchSuggestVO getSearchSuggestions(SearchSuggestQueryDTO queryDTO) {
        log.info("è·å–æœç´¢è”æƒ³: keyword={}", queryDTO.getKeyword());

        // è°ƒç”¨ RPC æ¥å£
        SearchSuggestVo rpcResult = remoteAppUserService.getSearchSuggestions(
            queryDTO.getKeyword(), 5
        );

        // è·å–è¯é¢˜è”æƒ³
        List<SearchSuggestVo.TopicSuggestVo> topicSuggests =
            remoteContentSearchService.getTopicSuggestions(queryDTO.getKeyword(), 3);

        // è½¬æ¢ç»“æœ
        SearchSuggestVO result = new SearchSuggestVO();
        result.setUsers(convertToUserSuggestItems(rpcResult.getUsers()));
        result.setTopics(convertToTopicSuggestItems(topicSuggests));
        result.setKeywords(rpcResult.getKeywords());

        return result;
    }

    @Override
    public SearchDeleteVO deleteSearchHistory(Long userId, SearchHistoryDeleteDTO deleteDTO) {
        log.info("åˆ é™¤æœç´¢å†å²: userId={}, deleteDTO={}", userId, deleteDTO);

        String keyword = deleteDTO.isClearAll() ? null : deleteDTO.getKeyword();
        Boolean success = remoteAppUserService.deleteSearchHistory(userId, keyword);

        SearchDeleteVO result = new SearchDeleteVO();
        result.setSuccess(success);
        result.setMessage(success ? "åˆ é™¤æˆåŠŸ" : "åˆ é™¤å¤±è´¥");
        return result;
    }

    // ========== è½¬æ¢æ–¹æ³• ==========

    private List<SearchInitVO.HotSearchItem> convertToHotSearchItems(List<HotSearchVo> list) {
        return list.stream().map(vo -> {
            SearchInitVO.HotSearchItem item = new SearchInitVO.HotSearchItem();
            item.setKeyword(vo.getKeyword());
            item.setDisplayText(vo.getDisplayText());
            item.setIcon(vo.getIcon());
            return item;
        }).collect(Collectors.toList());
    }

    private List<SearchSuggestVO.UserItem> convertToUserSuggestItems(List<SearchSuggestVo.UserSuggestVo> list) {
        if (list == null) return List.of();
        return list.stream().map(vo -> {
            SearchSuggestVO.UserItem item = new SearchSuggestVO.UserItem();
            item.setUserId(vo.getUserId());
            item.setNickname(vo.getNickname());
            item.setAvatar(vo.getAvatar());
            item.setIsVerified(vo.getIsVerified());
            return item;
        }).collect(Collectors.toList());
    }

    private List<SearchSuggestVO.TopicItem> convertToTopicSuggestItems(List<SearchSuggestVo.TopicSuggestVo> list) {
        if (list == null) return List.of();
        return list.stream().map(vo -> {
            SearchSuggestVO.TopicItem item = new SearchSuggestVO.TopicItem();
            item.setTopicId(vo.getTopicId());
            item.setTopicName(vo.getTopicName());
            item.setFeedCount(vo.getFeedCount());
            return item;
        }).collect(Collectors.toList());
    }
}
```

### 4.2 ä¿®æ”¹ HomeSearchResultServiceImpl

**æ–‡ä»¶**: `xypai-aggregation/xypai-app-bff/src/main/java/org/dromara/appbff/service/impl/HomeSearchResultServiceImpl.java`

```java
package org.dromara.appbff.service.impl;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.apache.dubbo.config.annotation.DubboReference;
import org.dromara.appbff.domain.dto.SearchQueryDTO;
import org.dromara.appbff.domain.vo.*;
import org.dromara.appbff.service.HomeSearchResultService;
import org.dromara.appuser.api.RemoteAppUserService;
import org.dromara.appuser.api.domain.dto.UserSearchDto;
import org.dromara.appuser.api.domain.vo.UserSearchPageResult;
import org.dromara.content.api.RemoteContentSearchService;
import org.dromara.content.api.domain.dto.ContentSearchDto;
import org.dromara.content.api.domain.vo.*;
import org.springframework.stereotype.Service;

/**
 * é¦–é¡µæœç´¢ç»“æœæœåŠ¡å®ç°ç±»ï¼ˆRPC ç‰ˆæœ¬ï¼‰
 */
@Slf4j
@Service
@RequiredArgsConstructor
public class HomeSearchResultServiceImpl implements HomeSearchResultService {

    @DubboReference
    private RemoteAppUserService remoteAppUserService;

    @DubboReference
    private RemoteContentSearchService remoteContentSearchService;

    @Override
    public SearchResultVO search(SearchQueryDTO queryDTO) {
        log.info("ç»¼åˆæœç´¢: {}", queryDTO);

        SearchResultVO result = new SearchResultVO();

        // æ ¹æ® type è¿”å›å¯¹åº”ç»“æœ
        switch (queryDTO.getType()) {
            case "all":
                result.setAllResult(searchAll(queryDTO));
                break;
            case "user":
                result.setUserResult(searchUsers(queryDTO, null));
                break;
            case "order":
                result.setOrderResult(searchOrders(queryDTO));
                break;
            case "topic":
                result.setTopicResult(searchTopics(queryDTO));
                break;
        }

        // è·å–å„ Tab ç»Ÿè®¡
        result.setTabs(getTabCounts(queryDTO.getKeyword()));

        return result;
    }

    @Override
    public SearchAllResultVO searchAll(SearchQueryDTO queryDTO) {
        log.info("æœç´¢å…¨éƒ¨Tab: {}", queryDTO);

        SearchAllResultVO result = new SearchAllResultVO();

        // 1. æœç´¢åŠ¨æ€
        ContentSearchDto contentSearchDto = new ContentSearchDto();
        contentSearchDto.setKeyword(queryDTO.getKeyword());
        contentSearchDto.setPageNum(queryDTO.getPageNum());
        contentSearchDto.setPageSize(queryDTO.getPageSize());
        FeedSearchPageResult feedResult = remoteContentSearchService.searchFeeds(contentSearchDto);
        result.setFeeds(convertToFeedItems(feedResult));

        // 2. æœç´¢ç”¨æˆ·ï¼ˆéƒ¨åˆ†ï¼‰
        UserSearchDto userSearchDto = new UserSearchDto();
        userSearchDto.setKeyword(queryDTO.getKeyword());
        userSearchDto.setPageNum(1);
        userSearchDto.setPageSize(3);
        UserSearchPageResult userResult = remoteAppUserService.searchUsers(userSearchDto);
        result.setUsers(convertToUserItems(userResult));

        result.setHasMore(feedResult.getHasMore());
        return result;
    }

    @Override
    public SearchUserResultVO searchUsers(SearchQueryDTO queryDTO, Long currentUserId) {
        log.info("æœç´¢ç”¨æˆ·Tab: {}, currentUserId={}", queryDTO, currentUserId);

        UserSearchDto searchDto = convertToUserSearchDto(queryDTO);
        searchDto.setCurrentUserId(currentUserId);

        UserSearchPageResult rpcResult = remoteAppUserService.searchUsers(searchDto);

        SearchUserResultVO result = new SearchUserResultVO();
        result.setList(convertToUserItems(rpcResult));
        result.setTotal(rpcResult.getTotal());
        result.setHasMore(rpcResult.getHasMore());
        return result;
    }

    @Override
    public SearchOrderResultVO searchOrders(SearchQueryDTO queryDTO) {
        log.info("æœç´¢ä¸‹å•Tab: {}", queryDTO);

        UserSearchDto searchDto = convertToUserSearchDto(queryDTO);

        UserSearchPageResult rpcResult = remoteAppUserService.searchServiceProviders(searchDto);

        SearchOrderResultVO result = new SearchOrderResultVO();
        result.setList(convertToOrderItems(rpcResult));
        result.setTotal(rpcResult.getTotal());
        result.setHasMore(rpcResult.getHasMore());
        return result;
    }

    @Override
    public SearchTopicResultVO searchTopics(SearchQueryDTO queryDTO) {
        log.info("æœç´¢è¯é¢˜Tab: {}", queryDTO);

        ContentSearchDto searchDto = new ContentSearchDto();
        searchDto.setKeyword(queryDTO.getKeyword());
        searchDto.setPageNum(queryDTO.getPageNum());
        searchDto.setPageSize(queryDTO.getPageSize());

        TopicSearchPageResult rpcResult = remoteContentSearchService.searchTopics(searchDto);

        SearchTopicResultVO result = new SearchTopicResultVO();
        result.setList(convertToTopicItems(rpcResult));
        result.setTotal(rpcResult.getTotal());
        result.setHasMore(rpcResult.getHasMore());
        return result;
    }

    // ========== è½¬æ¢æ–¹æ³• ==========

    private UserSearchDto convertToUserSearchDto(SearchQueryDTO dto) {
        UserSearchDto searchDto = new UserSearchDto();
        searchDto.setKeyword(dto.getKeyword());
        searchDto.setPageNum(dto.getPageNum());
        searchDto.setPageSize(dto.getPageSize());
        searchDto.setGender(dto.getGender());
        searchDto.setCityCode(dto.getCityCode());
        searchDto.setDistrictCode(dto.getDistrictCode());
        searchDto.setSortBy(dto.getSortBy());
        return searchDto;
    }

    private List<SearchResultVO.TabInfo> getTabCounts(String keyword) {
        // å¯é€‰: å¹¶è¡ŒæŸ¥è¯¢å„Tabæ•°é‡
        // ç®€åŒ–: è¿”å›å›ºå®šTabé…ç½®
        return List.of(
            new SearchResultVO.TabInfo("all", "å…¨éƒ¨", null),
            new SearchResultVO.TabInfo("user", "ç”¨æˆ·", null),
            new SearchResultVO.TabInfo("order", "ä¸‹å•", null),
            new SearchResultVO.TabInfo("topic", "è¯é¢˜", null)
        );
    }

    // ... å…¶ä»–è½¬æ¢æ–¹æ³•
}
```

---

## ğŸ§ª Step 5: æµ‹è¯•éªŒè¯

### 5.1 å•å…ƒæµ‹è¯•

```java
@SpringBootTest
public class HomeSearchServiceImplTest {

    @Autowired
    private HomeSearchService homeSearchService;

    @Test
    void testGetSearchInit() {
        SearchInitVO result = homeSearchService.getSearchInit(1L);

        assertNotNull(result);
        assertNotNull(result.getHotSearchList());
        assertFalse(result.getHotSearchList().isEmpty());
    }

    @Test
    void testSearchUsers() {
        SearchQueryDTO query = new SearchQueryDTO();
        query.setKeyword("ç‹è€…");
        query.setType("user");
        query.setPageNum(1);
        query.setPageSize(10);

        SearchUserResultVO result = homeSearchResultService.searchUsers(query, null);

        assertNotNull(result);
        assertNotNull(result.getList());
    }
}
```

### 5.2 é›†æˆæµ‹è¯•

ä½¿ç”¨å·²æœ‰çš„æµ‹è¯•æ–‡ä»¶:
- `Page06_SearchPageTest.java`
- `Page07_SearchResultTest.java`

---

## ğŸ” Elasticsearch å¯é€‰é›†æˆ

### æ¨èåœºæ™¯
- ç”¨æˆ·æ•°é‡ > 10ä¸‡
- æœç´¢è¯·æ±‚ QPS > 100
- éœ€è¦å¤æ‚çš„å…¨æ–‡æœç´¢ï¼ˆåˆ†è¯ã€åŒä¹‰è¯ï¼‰

### é›†æˆæ–¹æ¡ˆ

```yaml
# application.yml
spring:
  elasticsearch:
    uris: http://localhost:9200
```

```java
// åˆ›å»º ES ç´¢å¼•
@Document(indexName = "xypai_user")
public class UserSearchDoc {
    @Id
    private Long userId;

    @Field(type = FieldType.Text, analyzer = "ik_max_word")
    private String nickname;

    @Field(type = FieldType.Keyword)
    private String gender;

    @Field(type = FieldType.Text, analyzer = "ik_smart")
    private List<String> skillTypes;

    // ...
}
```

---

## ğŸ“Š æ•°æ®æ˜ å°„å…³ç³»

### BFF VO â†’ RPC VO å­—æ®µæ˜ å°„

| BFF å­—æ®µ | RPC å­—æ®µ | è¯´æ˜ |
|----------|----------|------|
| `SearchInitVO.hotSearchList` | `List<HotSearchVo>` | çƒ­é—¨æœç´¢ |
| `SearchInitVO.historyList` | `List<String>` | æœç´¢å†å² |
| `SearchUserResultVO.list[].userId` | `UserSearchVo.userId` | ç”¨æˆ·ID |
| `SearchUserResultVO.list[].isFollowed` | `UserSearchVo.isFollowed` | å…³æ³¨çŠ¶æ€ |
| `SearchTopicResultVO.list[].topicId` | `TopicSearchVo.topicId` | è¯é¢˜ID |

---

## ğŸ”— è·¨æœåŠ¡ä¾èµ–

| æœåŠ¡ | æ¥å£ | ç”¨é€” |
|------|------|------|
| `RemoteAppUserService` | `getHotSearchKeywords()` | çƒ­é—¨æœç´¢ |
| `RemoteAppUserService` | `getUserSearchHistory()` | ç”¨æˆ·å†å² |
| `RemoteAppUserService` | `searchUsers()` | ç”¨æˆ·æœç´¢ |
| `RemoteContentSearchService` | `searchFeeds()` | åŠ¨æ€æœç´¢ |
| `RemoteContentSearchService` | `searchTopics()` | è¯é¢˜æœç´¢ |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æœç´¢æ€§èƒ½**: å…³é”®è¯æœç´¢ä½¿ç”¨ LIKE æ•ˆç‡è¾ƒä½ï¼Œæ•°æ®é‡å¤§æ—¶è€ƒè™‘ ES
2. **æœç´¢å†å²**: æ¯ä¸ªç”¨æˆ·æœ€å¤šä¿ç•™ 10 æ¡å†å²ï¼Œå®šæœŸæ¸…ç†
3. **çƒ­é—¨æœç´¢**: å¯é…ç½®å®šæ—¶æ›´æ–°æˆ–æ‰‹åŠ¨ç®¡ç†
4. **æœç´¢è”æƒ³**: éœ€è¦é˜²æŠ–å¤„ç†ï¼Œå‰ç«¯ 300ms å»¶è¿Ÿ
5. **é«˜äº®æ˜¾ç¤º**: æœç´¢ç»“æœä¸­çš„å…³é”®è¯é«˜äº®éœ€è¦åœ¨ BFF å±‚å¤„ç†
6. **æ•æ„Ÿè¯è¿‡æ»¤**: æœç´¢å…³é”®è¯éœ€è¦è¿‡æ»¤æ•æ„Ÿè¯

---

## ğŸ“… é¢„è®¡å·¥æ—¶

| ä»»åŠ¡ | å·¥æ—¶ | è´Ÿè´£äºº |
|------|------|--------|
| æ•°æ®åº“è®¾è®¡ä¸å»ºè¡¨ | 0.5 å¤© | |
| RPC æ¥å£å®šä¹‰ (DTO/VO) | 1 å¤© | |
| xypai-user æœç´¢å®ç° | 1 å¤© | |
| xypai-content æœç´¢å®ç° | 1 å¤© | |
| BFF å±‚é›†æˆ | 0.5 å¤© | |
| æµ‹è¯•éªŒè¯ | 0.5 å¤© | |
| **æ€»è®¡** | **4.5 å¤©** | |

### å¯é€‰æ‰©å±•

| ä»»åŠ¡ | å·¥æ—¶ | è¯´æ˜ |
|------|------|------|
| Elasticsearch é›†æˆ | 2 å¤© | é«˜å¹¶å‘åœºæ™¯ |
| æœç´¢åˆ†è¯ä¼˜åŒ– | 1 å¤© | ä½¿ç”¨ IK åˆ†è¯ |

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [é›†æˆæ–‡æ¡£-01-æŠ€èƒ½æœåŠ¡æ¨¡å—](./é›†æˆæ–‡æ¡£-01-æŠ€èƒ½æœåŠ¡æ¨¡å—.md)
- [é›†æˆæ–‡æ¡£-02-ç»„å±€ä¸­å¿ƒæ¨¡å—](./é›†æˆæ–‡æ¡£-02-ç»„å±€ä¸­å¿ƒæ¨¡å—.md)
- [BFF å¿«é€Ÿç†è§£](../å¿«é€Ÿç†è§£.md)
- [RPC é›†æˆè®¡åˆ’](../RPCé›†æˆè®¡åˆ’.md)
- [å‰ç«¯æ–‡æ¡£: 06-æœç´¢é¡µé¢.md](å‰ç«¯æ–‡æ¡£é“¾æ¥)
- [å‰ç«¯æ–‡æ¡£: 07-æœç´¢ç»“æœé¡µé¢.md](å‰ç«¯æ–‡æ¡£é“¾æ¥)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æœ€åæ›´æ–°**: 2025-11-26
