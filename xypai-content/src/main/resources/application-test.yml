server:
  servlet:
    context-path: /content

spring:
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    # Test database - ensure you create xypai_content_test database first
    url: jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/xypai_content_test?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8&autoReconnect=true&rewriteBatchedStatements=true&allowPublicKeyRetrieval=true
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:root}
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  # Redis配置 - Use separate database for tests
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      database: 15  # Use database 15 for tests to avoid conflicts
      timeout: 10s
      ssl:
        enabled: false

  # Cloud config - disabled for tests
  cloud:
    nacos:
      discovery:
        enabled: false
      config:
        enabled: false

# Dubbo配置 - disabled for tests
dubbo:
  application:
    name: ${spring.application.name}
    qos-enable: false
  protocol:
    name: dubbo
    port: -1
  registry:
    address: N/A  # Disable registry for tests
  consumer:
    check: false
    timeout: 3000
    retries: 0

# MyBatis Plus配置
mybatis-plus:
  mapper-locations: classpath*:mapper/**/*Mapper.xml
  type-aliases-package: org.dromara.content.domain.entity
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: false
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl
  global-config:
    db-config:
      id-type: ASSIGN_ID
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
      update-strategy: NOT_NULL

# 日志配置 - simplified for tests
logging:
  level:
    root: WARN
    org.dromara.content: DEBUG
    org.springframework: WARN
    org.springframework.test: INFO
    org.springframework.boot.test: INFO
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Sa-Token配置 - simplified for tests
sa-token:
  token-name: Authorization
  timeout: 86400  # 1 day for tests
  active-timeout: -1
  check-same-token: false  # Disable for tests

# Knife4j配置 - disabled for tests
knife4j:
  enable: false
  production: true
