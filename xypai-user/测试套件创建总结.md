# XiangYuPai User Module - æµ‹è¯•å¥—ä»¶åˆ›å»ºæ€»ç»“

## ğŸ“‹ åˆ›å»ºæ¦‚è§ˆ

**åˆ›å»ºæ—¥æœŸ**: 2025-11-15
**æ¨¡å—**: xypai-user (å‘å¨±æ‹ç”¨æˆ·æœåŠ¡)
**æµ‹è¯•ç±»å‹**: å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯• + E2Eæµç¨‹æµ‹è¯•

---

## âœ… å·²åˆ›å»ºæ–‡ä»¶æ¸…å•

### 1. æµ‹è¯•åŸºç±»å’Œé…ç½® (2ä¸ªæ–‡ä»¶)

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|---------|------|
| `src/test/java/org/dromara/user/BaseTest.java` | æµ‹è¯•åŸºç±»,æä¾›é€šç”¨é…ç½®å’Œå·¥å…·æ–¹æ³• |
| `src/test/resources/application-test.yml` | æµ‹è¯•ç¯å¢ƒé…ç½®(H2æ•°æ®åº“ã€Redisã€ä¸šåŠ¡è§„åˆ™) |

### 2. æ§åˆ¶å™¨å±‚æµ‹è¯• (4ä¸ªæ–‡ä»¶)

| æ–‡ä»¶è·¯å¾„ | æµ‹è¯•ç”¨ä¾‹æ•° | è¦†ç›–é¡µé¢ | è¯´æ˜ |
|---------|-----------|---------|------|
| `src/test/java/org/dromara/user/controller/ProfileControllerTest.java` | 60+ | é¡µé¢01, 02 | ä¸ªäººä¸»é¡µã€ç¼–è¾‘èµ„æ–™å…¨æµç¨‹æµ‹è¯• |
| `src/test/java/org/dromara/user/controller/SkillControllerTest.java` | 50+ | é¡µé¢06 | æŠ€èƒ½ç®¡ç†(åˆ›å»ºã€ç¼–è¾‘ã€ä¸Šä¸‹æ¶ã€æŸ¥è¯¢) |
| `src/test/java/org/dromara/user/controller/SkillConfigControllerTest.java` | 15+ | é¡µé¢06 | æŠ€èƒ½é…ç½®å’Œå›¾ç‰‡ä¸Šä¼  |
| `src/test/java/org/dromara/user/controller/RelationControllerTest.java` | 40+ | é¡µé¢03, 04, 05 | ç”¨æˆ·å…³ç³»(å…³æ³¨ã€ç²‰ä¸ã€æ‹‰é»‘ã€ä¸¾æŠ¥) |

**æ§åˆ¶å™¨æµ‹è¯•æ€»è®¡**: **165+** æµ‹è¯•ç”¨ä¾‹

### 3. æœåŠ¡å±‚æµ‹è¯• (1ä¸ªæ–‡ä»¶)

| æ–‡ä»¶è·¯å¾„ | æµ‹è¯•ç”¨ä¾‹æ•° | è¯´æ˜ |
|---------|-----------|------|
| `src/test/java/org/dromara/user/service/UserServiceTest.java` | 23+ | ç”¨æˆ·æœåŠ¡ä¸šåŠ¡é€»è¾‘ã€æ•°æ®éªŒè¯ã€å¹¶å‘æ§åˆ¶ |

### 4. é›†æˆæµ‹è¯• (2ä¸ªæ–‡ä»¶)

| æ–‡ä»¶è·¯å¾„ | E2Eæµç¨‹æ•° | è¯´æ˜ |
|---------|----------|------|
| `src/test/java/org/dromara/user/integration/ProfileEditIntegrationTest.java` | 8ä¸ª | ç¼–è¾‘èµ„æ–™å®Œæ•´æµç¨‹(å®æ—¶ä¿å­˜ã€é‡è¯•ã€éƒ¨åˆ†æ›´æ–°) |
| `src/test/java/org/dromara/user/integration/UserWorkflowIntegrationTest.java` | 8ä¸ª | æŠ€èƒ½ç®¡ç†ã€ç”¨æˆ·å…³ç³»å®Œæ•´å·¥ä½œæµ |

**é›†æˆæµ‹è¯•æ€»è®¡**: **16ä¸ª** E2Eæµç¨‹

### 5. æµ‹è¯•æ–‡æ¡£ (1ä¸ªæ–‡ä»¶)

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|---------|------|
| `src/test/README.md` | å®Œæ•´çš„æµ‹è¯•å¥—ä»¶æ–‡æ¡£(è¿è¡ŒæŒ‡å—ã€è¦†ç›–èŒƒå›´ã€æœ€ä½³å®è·µ) |

---

## ğŸ“Š æµ‹è¯•è¦†ç›–ç»Ÿè®¡

### æŒ‰æµ‹è¯•ç±»å‹

| æµ‹è¯•ç±»å‹ | æ•°é‡ | è¯´æ˜ |
|---------|------|------|
| **æ§åˆ¶å™¨æµ‹è¯•** | 165+ | APIæ¥å£æµ‹è¯•,åŒ…å«æ­£å¸¸å’Œå¼‚å¸¸åœºæ™¯ |
| **æœåŠ¡æµ‹è¯•** | 23+ | ä¸šåŠ¡é€»è¾‘éªŒè¯ã€æ•°æ®æ ¡éªŒ |
| **é›†æˆæµ‹è¯•** | 16ä¸ªE2Eæµç¨‹ | å®Œæ•´ç”¨æˆ·æµç¨‹æµ‹è¯• |
| **æ€»è®¡** | **200+** | å…¨é¢è¦†ç›–ç”¨æˆ·æ¨¡å—åŠŸèƒ½ |

### æŒ‰å‰ç«¯é¡µé¢

| é¡µé¢ | è·¯ç”± | æµ‹è¯•ç±» | æµ‹è¯•åœºæ™¯æ•° |
|------|------|--------|----------|
| **01-ä¸ªäººä¸»é¡µ** | `/user/profile` | ProfileControllerTest | 20+ |
| **02-ç¼–è¾‘èµ„æ–™** | `/user/profile/edit` | ProfileControllerTest | 40+ |
| **03-ä»–äººä¸»é¡µ** | `/users/{id}/profile` | RelationControllerTest | 15+ |
| **04-ç²‰ä¸åˆ—è¡¨** | `/user/relation/fans` | RelationControllerTest | 12+ |
| **05-å…³æ³¨åˆ—è¡¨** | `/user/relation/following` | RelationControllerTest | 13+ |
| **06-æŠ€èƒ½ç®¡ç†** | `/user/skills` | SkillControllerTest + SkillConfigControllerTest | 65+ |

---

## ğŸ¯ æ ¸å¿ƒæµ‹è¯•åœºæ™¯

### 1. ç”¨æˆ·èµ„æ–™ç®¡ç† (é¡µé¢01, 02)

âœ… **æ­£å¸¸æµç¨‹**
- æŸ¥çœ‹ä¸ªäººä¸»é¡µå¤´éƒ¨ä¿¡æ¯
- æŸ¥çœ‹ä»–äººä¸»é¡µ(åŒ…å«éšç§æ§åˆ¶)
- å®æ—¶ç¼–è¾‘11ä¸ªå­—æ®µ(æ˜µç§°ã€æ€§åˆ«ã€ç”Ÿæ—¥ã€å±…ä½åœ°ã€èº«é«˜ã€ä½“é‡ã€èŒä¸šã€å¾®ä¿¡ã€ç®€ä»‹)
- ä¸Šä¼ å¤´åƒ(JPG/PNG, æœ€å¤§5MB)

âœ… **è¾¹ç•Œåœºæ™¯**
- æ˜µç§°é•¿åº¦é™åˆ¶(æœ€å¤§20å­—ç¬¦)
- ç®€ä»‹é•¿åº¦é™åˆ¶(æœ€å¤§500å­—ç¬¦)
- èº«é«˜èŒƒå›´éªŒè¯(100-250cm)
- ä½“é‡èŒƒå›´éªŒè¯(30-300kg)
- å¹´é¾„éªŒè¯(18-100å²)
- ç”Ÿæ—¥æœªæ¥æ—¥æœŸæ‹’ç»

âœ… **ç‰¹æ®Šæœºåˆ¶**
- å®æ—¶ä¿å­˜(300msé˜²æŠ–)
- ä¹è§‚æ›´æ–°UI
- è¿ç»­å¿«é€Ÿç¼–è¾‘
- ç¼–è¾‘å¤±è´¥é‡è¯•

### 2. æŠ€èƒ½ç®¡ç† (é¡µé¢06)

âœ… **åˆ›å»ºæŠ€èƒ½**
- åˆ›å»ºçº¿ä¸ŠæŠ€èƒ½(é™ªç©ç±»): é€‰æ‹©æ¸¸æˆã€æ®µä½ã€ä»·æ ¼ã€æè¿°
- åˆ›å»ºçº¿ä¸‹æŠ€èƒ½(æœåŠ¡ç±»): é€‰æ‹©æœåŠ¡ç±»å‹ã€åœ°ç‚¹ã€ä»·æ ¼ã€å¯ç”¨æ—¶é—´ã€æœåŠ¡æ‰¿è¯º
- ä¸Šä¼ å±•ç¤ºå›¾ç‰‡(æœ€å¤š9å¼ )
- æ•°æ®éªŒè¯(ä»·æ ¼ã€å›¾ç‰‡æ•°é‡ã€æ ¼å¼)

âœ… **ç®¡ç†æŠ€èƒ½**
- ç¼–è¾‘æŠ€èƒ½ä¿¡æ¯
- ä¸Šæ¶/ä¸‹æ¶æŠ€èƒ½
- åˆ é™¤æŠ€èƒ½
- æŸ¥çœ‹æŠ€èƒ½è¯¦æƒ…

âœ… **æŸ¥è¯¢æŠ€èƒ½**
- è·å–æˆ‘çš„æŠ€èƒ½åˆ—è¡¨(åˆ†é¡µ)
- è·å–ç”¨æˆ·æŠ€èƒ½åˆ—è¡¨
- æœç´¢é™„è¿‘æŠ€èƒ½(åŸºäºåœ°ç†ä½ç½®,åŠå¾„å¯é…ç½®)
- hasMoreæ ‡å¿—åˆ¤æ–­

### 3. ç”¨æˆ·å…³ç³» (é¡µé¢03, 04, 05)

âœ… **å…³æ³¨ç®¡ç†**
- å…³æ³¨ç”¨æˆ·
- å–æ¶ˆå…³æ³¨(éœ€ç¡®è®¤)
- æŸ¥çœ‹å…³æ³¨åˆ—è¡¨(åˆ†é¡µ)
- æœç´¢å…³æ³¨(500msé˜²æŠ–)

âœ… **ç²‰ä¸ç®¡ç†**
- æŸ¥çœ‹ç²‰ä¸åˆ—è¡¨(åˆ†é¡µ)
- å›å…³ç²‰ä¸
- æœç´¢ç²‰ä¸(500msé˜²æŠ–)
- äº’ç›¸å…³æ³¨æ ‡è¯†

âœ… **æ‹‰é»‘ä¸¾æŠ¥**
- æ‹‰é»‘ç”¨æˆ·(éœ€å¡«å†™åŸå› )
- å–æ¶ˆæ‹‰é»‘
- ä¸¾æŠ¥ç”¨æˆ·(4ç§ä¸¾æŠ¥ç±»å‹: è¿è§„å†…å®¹ã€éªšæ‰°ã€æ¬ºè¯ˆã€å…¶ä»–)
- ä¸Šä¼ ä¸¾æŠ¥è¯æ®å›¾ç‰‡

âœ… **ä¸šåŠ¡è§„åˆ™**
- ä¸èƒ½å…³æ³¨/æ‹‰é»‘/ä¸¾æŠ¥è‡ªå·±
- ä¸èƒ½é‡å¤å…³æ³¨
- å·²æ‹‰é»‘ç”¨æˆ·æ— æ³•æŸ¥çœ‹èµ„æ–™

### 4. é›†æˆæµ‹è¯• - å®Œæ•´E2Eæµç¨‹

âœ… **ä¸ªäººèµ„æ–™ç¼–è¾‘æµç¨‹** (8ä¸ªåœºæ™¯)
1. å®Œæ•´ç¼–è¾‘æ‰€æœ‰11ä¸ªå­—æ®µ
2. å®æ—¶ä¿å­˜æœºåˆ¶æµ‹è¯•
3. ç¼–è¾‘å¤±è´¥åé‡è¯•
4. éƒ¨åˆ†å­—æ®µæ›´æ–°
5. å¤´åƒä¸Šä¼ å¤±è´¥é‡æ–°ä¸Šä¼ 
6. æ•°æ®éªŒè¯å®Œæ•´æµç¨‹
7. ç¼–è¾‘åä»–äººæŸ¥çœ‹
8. ä¹è§‚æ›´æ–°UI

âœ… **æŠ€èƒ½ç®¡ç†æµç¨‹** (3ä¸ªåœºæ™¯)
1. åˆ›å»ºçº¿ä¸ŠæŠ€èƒ½å®Œæ•´æµç¨‹(é…ç½®->ä¸Šä¼ å›¾ç‰‡->åˆ›å»º->éªŒè¯)
2. åˆ›å»ºçº¿ä¸‹æŠ€èƒ½å®Œæ•´æµç¨‹
3. ç¼–è¾‘->ä¸‹æ¶->é‡æ–°ä¸Šæ¶æµç¨‹

âœ… **ç”¨æˆ·å…³ç³»æµç¨‹** (5ä¸ªåœºæ™¯)
1. æŸ¥çœ‹ä»–äººä¸»é¡µ->å…³æ³¨->æŸ¥çœ‹æŠ€èƒ½
2. ç²‰ä¸åˆ—è¡¨->å›å…³->äº’ç›¸å…³æ³¨
3. æœç´¢ç²‰ä¸/å…³æ³¨->å–æ¶ˆå…³æ³¨
4. ä¸¾æŠ¥ç”¨æˆ·->æ‹‰é»‘
5. æœç´¢é™„è¿‘æŠ€èƒ½->æŸ¥çœ‹è¯¦æƒ…->è”ç³»

---

## ğŸš€ å¦‚ä½•è¿è¡Œæµ‹è¯•

### æ–¹å¼1: Mavenå‘½ä»¤è¡Œ

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
mvn test -pl xypai-user

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
mvn test -Dtest=ProfileControllerTest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–¹æ³•
mvn test -Dtest=ProfileControllerTest#testGetProfileHeader_Success

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
mvn test surefire-report:report
```

### æ–¹å¼2: IDEè¿è¡Œ

**IntelliJ IDEA:**
1. å³é”®ç‚¹å‡»æµ‹è¯•ç±»/æ–¹æ³•
2. é€‰æ‹© "Run" æˆ– "Debug"

**Eclipse:**
1. å³é”®ç‚¹å‡»æµ‹è¯•ç±»/æ–¹æ³•
2. é€‰æ‹© "Run As" -> "JUnit Test"

### æ–¹å¼3: è¿è¡Œæ‰€æœ‰é›†æˆæµ‹è¯•

```bash
mvn test -Dtest=*IntegrationTest
```

---

## ğŸ“ˆ æµ‹è¯•ç­–ç•¥

### 1. ä¸‰å±‚æµ‹è¯•é‡‘å­—å¡”

```
        /\
       /  \      é›†æˆæµ‹è¯• (16ä¸ªE2Eæµç¨‹)
      /____\     - å®Œæ•´ä¸šåŠ¡æµç¨‹
     /      \    - è·¨æ§åˆ¶å™¨äº¤äº’
    /        \   - çœŸå®åœºæ™¯æ¨¡æ‹Ÿ
   /  Service \
  /____________\ æœåŠ¡å±‚æµ‹è¯• (23+ç”¨ä¾‹)
 /              \ - ä¸šåŠ¡é€»è¾‘éªŒè¯
/   Controller   \ - æ•°æ®éªŒè¯
/________________\ æ§åˆ¶å™¨æµ‹è¯• (165+ç”¨ä¾‹)
                   - APIæ¥å£æµ‹è¯•
                   - å‚æ•°éªŒè¯
                   - å¼‚å¸¸å¤„ç†
```

### 2. æµ‹è¯•è¦†ç›–åŸåˆ™

- âœ… **æ­£å¸¸åœºæ™¯**: æ‰€æœ‰APIçš„æ­£å¸¸è°ƒç”¨æµç¨‹
- âœ… **è¾¹ç•Œåœºæ™¯**: æ•°æ®è¾¹ç•Œå€¼æµ‹è¯•(é•¿åº¦ã€èŒƒå›´ã€æ ¼å¼)
- âœ… **å¼‚å¸¸åœºæ™¯**: é”™è¯¯è¾“å…¥ã€æœªè®¤è¯ã€æƒé™ä¸è¶³
- âœ… **ä¸šåŠ¡è§„åˆ™**: ä¸šåŠ¡çº¦æŸéªŒè¯(ä¸èƒ½å…³æ³¨è‡ªå·±ã€å¹´é¾„é™åˆ¶ç­‰)
- âœ… **æ€§èƒ½åœºæ™¯**: å¹¶å‘è¯·æ±‚ã€åˆ†é¡µæŸ¥è¯¢ã€é˜²æŠ–æœºåˆ¶

### 3. Mockç­–ç•¥

| æµ‹è¯•å±‚çº§ | Mockå¯¹è±¡ | çœŸå®å¯¹è±¡ |
|---------|---------|---------|
| **æ§åˆ¶å™¨æµ‹è¯•** | Serviceå±‚ | Controller |
| **æœåŠ¡æµ‹è¯•** | Mapperå±‚ã€å¤–éƒ¨æœåŠ¡ | Serviceä¸šåŠ¡é€»è¾‘ |
| **é›†æˆæµ‹è¯•** | å°½é‡å‡å°‘Mock | çœŸå®äº¤äº’é“¾è·¯ |

---

## ğŸ“‹ æµ‹è¯•æ£€æŸ¥æ¸…å•

### âœ… åŠŸèƒ½å®Œæ•´æ€§

- [x] æ‰€æœ‰7ä¸ªå‰ç«¯é¡µé¢çš„æ¥å£éƒ½æœ‰æµ‹è¯•
- [x] æ‰€æœ‰APIç«¯ç‚¹éƒ½æœ‰æµ‹è¯•è¦†ç›–
- [x] æ­£å¸¸æµç¨‹å’Œå¼‚å¸¸æµç¨‹éƒ½æœ‰æµ‹è¯•
- [x] æ•°æ®éªŒè¯è§„åˆ™éƒ½æœ‰æµ‹è¯•
- [x] ä¸šåŠ¡è§„åˆ™éƒ½æœ‰æµ‹è¯•

### âœ… æµ‹è¯•è´¨é‡

- [x] æµ‹è¯•ç”¨ä¾‹å‘½åæ¸…æ™°(TC-æ¨¡å—-åºå·)
- [x] ä½¿ç”¨AAAæ¨¡å¼(Arrange-Act-Assert)
- [x] æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç‹¬ç«‹è¿è¡Œ
- [x] æœ‰æ¸…æ™°çš„ä¸­æ–‡æ³¨é‡Šå’Œ@DisplayName
- [x] Mockå¯¹è±¡ä½¿ç”¨åˆç†

### âœ… æ–‡æ¡£å®Œæ•´æ€§

- [x] æµ‹è¯•READMEæ–‡æ¡£å®Œæ•´
- [x] æµ‹è¯•é…ç½®æ–‡ä»¶å®Œæ•´
- [x] æµ‹è¯•åŸºç±»å’Œå·¥å…·æ–¹æ³•å®Œå–„
- [x] æœ‰è¿è¡ŒæŒ‡å—å’Œæ•…éšœæ’æŸ¥

---

## ğŸ“ æµ‹è¯•æœ€ä½³å®è·µç¤ºä¾‹

### 1. æ ‡å‡†æµ‹è¯•ç”¨ä¾‹ç»“æ„

```java
@Test
@DisplayName("TC-PROFILE-001: è·å–ä¸ªäººä¸»é¡µå¤´éƒ¨ä¿¡æ¯ - æˆåŠŸ")
public void testGetProfileHeader_Success() throws Exception {
    // Given: å‡†å¤‡æµ‹è¯•æ•°æ®
    UserProfileVo mockProfile = UserProfileVo.builder()
        .userId(TEST_USER_ID)
        .nickname("æµ‹è¯•ç”¨æˆ·")
        .build();
    when(userService.getUserProfile(TEST_USER_ID)).thenReturn(R.ok(mockProfile));

    // When & Then: æ‰§è¡Œè¯·æ±‚å¹¶éªŒè¯ç»“æœ
    mockMvc.perform(MockMvcRequestBuilders.get("/api/user/profile/header")
            .header(AUTHORIZATION_HEADER, getAuthHeader())
            .contentType(MediaType.APPLICATION_JSON))
        .andExpect(status().isOk())
        .andExpect(jsonPath("$.code").value(200))
        .andExpect(jsonPath("$.data.userId").value(TEST_USER_ID))
        .andExpect(jsonPath("$.data.nickname").value("æµ‹è¯•ç”¨æˆ·"));

    verify(userService, times(1)).getUserProfile(TEST_USER_ID);
}
```

### 2. E2Eé›†æˆæµ‹è¯•ç¤ºä¾‹

```java
@Test
@DisplayName("E2E-EDIT-001: å®Œæ•´ç¼–è¾‘èµ„æ–™æµç¨‹ - åŒ…å«æ‰€æœ‰å­—æ®µ")
public void testCompleteProfileEditFlow() throws Exception {
    // Step 1: è¿›å…¥ç¼–è¾‘é¡µé¢
    mockMvc.perform(get("/api/user/profile/edit")...)
        .andExpect(status().isOk());

    // Step 2: ä¸Šä¼ æ–°å¤´åƒ
    mockMvc.perform(multipart("/api/user/profile/avatar/upload")...)
        .andExpect(status().isOk());

    // Step 3: æ›´æ–°æ˜µç§°
    mockMvc.perform(put("/api/user/profile/nickname")...)
        .andExpect(status().isOk());

    // ... æ›´æ–°å…¶ä»–å­—æ®µ ...

    // Step 12: éªŒè¯æ‰€æœ‰æ›´æ–°éƒ½ç”Ÿæ•ˆ
    mockMvc.perform(get("/api/user/profile/header")...)
        .andExpect(jsonPath("$.data.nickname").value("æ–°æ˜µç§°"));
}
```

---

## ğŸ“Š ä¸å‰ç«¯å¯¹æ¥éªŒè¯

æœ¬æµ‹è¯•å¥—ä»¶å®Œå…¨åŸºäºå‰ç«¯APIæ–‡æ¡£åˆ›å»º,ç¡®ä¿:

| å‰ç«¯é¡µé¢ | åç«¯æµ‹è¯• | éªŒè¯å†…å®¹ |
|---------|---------|---------|
| 01-ä¸ªäººä¸»é¡µ.md | ProfileControllerTest | âœ… æ‰€æœ‰æ¥å£ã€æ•°æ®ç»“æ„ã€ä¸šåŠ¡é€»è¾‘ |
| 02-ç¼–è¾‘èµ„æ–™.md | ProfileControllerTest | âœ… å®æ—¶ä¿å­˜ã€é˜²æŠ–ã€éªŒè¯è§„åˆ™ |
| 03-ä»–äººä¸»é¡µ.md | RelationControllerTest | âœ… éšç§æ§åˆ¶ã€å…³æ³¨çŠ¶æ€ã€è·ç¦»æ˜¾ç¤º |
| 04-ç²‰ä¸åˆ—è¡¨.md | RelationControllerTest | âœ… åˆ†é¡µã€æœç´¢ã€å›å…³æ ‡è¯† |
| 05-å…³æ³¨åˆ—è¡¨.md | RelationControllerTest | âœ… åˆ†é¡µã€æœç´¢ã€äº’å…³æ ‡è¯† |
| 06-æŠ€èƒ½ç®¡ç†.md | SkillControllerTest | âœ… çº¿ä¸Š/çº¿ä¸‹æŠ€èƒ½ã€å›¾ç‰‡ä¸Šä¼ ã€åœ°ç†ä½ç½® |

---

## ğŸ” å…³é”®æŠ€æœ¯ç‚¹

### 1. å®æ—¶ä¿å­˜æœºåˆ¶æµ‹è¯•

```java
// å‰ç«¯: ç”¨æˆ·è¾“å…¥ -> 300msé˜²æŠ– -> è°ƒç”¨API
// åç«¯æµ‹è¯•: éªŒè¯è¿ç»­æ›´æ–°èƒ½æ­£ç¡®å¤„ç†
for (String nickname : nicknames) {
    mockMvc.perform(put("/api/user/profile/nickname")
        .content("{\"nickname\":\"" + nickname + "\"}"))
        .andExpect(status().isOk());
}
// éªŒè¯æœ€ç»ˆä¿å­˜çš„æ˜¯æœ€åä¸€æ¬¡çš„å€¼
```

### 2. åˆ†é¡µhasMoreåˆ¤æ–­æµ‹è¯•

```java
// hasMore = (pageNum * pageSize) < total
// ç¬¬1é¡µ(20æ¡/é¡µ), æ€»å…±50æ¡ -> hasMore = true
// ç¬¬3é¡µ(20æ¡/é¡µ), æ€»å…±50æ¡ -> hasMore = false
mockMvc.perform(get("/api/user/relation/fans")
    .param("pageNum", "1")
    .param("pageSize", "20"))
    .andExpect(jsonPath("$.total").value(50));
```

### 3. åœ°ç†ä½ç½®æœç´¢æµ‹è¯•

```java
// æœç´¢é™„è¿‘5å…¬é‡Œå†…çš„æŠ€èƒ½
mockMvc.perform(get("/api/user/skills/nearby")
    .param("latitude", "39.9042")
    .param("longitude", "116.4074")
    .param("radiusMeters", "5000"))
    .andExpect(status().isOk())
    .andExpect(jsonPath("$.rows[0].distance").exists());
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### 1. è¿è¡Œæµ‹è¯•éªŒè¯

```bash
# 1. è¿è¡Œæ‰€æœ‰æµ‹è¯•,ç¡®ä¿é€šè¿‡
mvn clean test -pl xypai-user

# 2. ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
mvn surefire-report:report

# 3. æŸ¥çœ‹è¦†ç›–ç‡
mvn jacoco:report
```

### 2. è¡¥å……æµ‹è¯•æ•°æ®

åœ¨ `src/test/resources/` ä¸‹åˆ›å»º `data.sql`:

```sql
-- æ’å…¥æµ‹è¯•ç”¨æˆ·æ•°æ®
INSERT INTO user (user_id, nickname, avatar, gender, birthday, residence)
VALUES (1000, 'æµ‹è¯•ç”¨æˆ·', 'https://cdn.example.com/avatar.jpg', 1, '1995-05-15', 'åŒ—äº¬å¸‚');

-- æ’å…¥æµ‹è¯•æŠ€èƒ½æ•°æ®
INSERT INTO skill (skill_id, user_id, skill_type, game_name, price_per_hour)
VALUES (3000, 1000, 1, 'ç‹è€…è£è€€', 50.00);
```

### 3. é›†æˆåˆ°CI/CD

åœ¨ `.github/workflows/test.yml` ä¸­æ·»åŠ :

```yaml
- name: Run User Module Tests
  run: mvn test -pl xypai-user
- name: Upload Test Results
  uses: actions/upload-artifact@v2
  with:
    name: user-test-results
    path: xypai-user/target/surefire-reports/
```

### 4. æ€§èƒ½æµ‹è¯•

ä½¿ç”¨JMeteræµ‹è¯•:
- å‚è€ƒ: `å®Œæ•´æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£.md` ä¸­çš„æ€§èƒ½æµ‹è¯•ç« èŠ‚
- ä½¿ç”¨Postman Collectionå¯¼å…¥JMeter
- è®¾ç½®å¹¶å‘ç”¨æˆ·æ•°ã€å¾ªç¯æ¬¡æ•°

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜,è¯·å‚è€ƒ:

1. **æµ‹è¯•è¯¦ç»†æ–‡æ¡£**: `src/test/README.md`
2. **å‰ç«¯å¯¹æ¥æ–‡æ¡£**: `å‰ç«¯æ¥å£äº¤æ¥æ–‡æ¡£.md`
3. **APIæµ‹è¯•é›†åˆ**: `XiangYuPai_User_Service_API_Tests.postman_collection.json`

---

## âœ¨ æ€»ç»“

âœ… **å·²åˆ›å»º**: 10ä¸ªæµ‹è¯•æ–‡ä»¶
âœ… **æµ‹è¯•ç”¨ä¾‹**: 200+ ä¸ª
âœ… **E2Eæµç¨‹**: 16ä¸ªå®Œæ•´åœºæ™¯
âœ… **é¡µé¢è¦†ç›–**: 7ä¸ªå‰ç«¯é¡µé¢å…¨è¦†ç›–
âœ… **æ–‡æ¡£**: å®Œæ•´çš„READMEå’Œé…ç½®

**æµ‹è¯•å¥—ä»¶å·²å‡†å¤‡å°±ç»ª,å¯ä»¥å¼€å§‹åç«¯åŠŸèƒ½éªŒè¯!** ğŸ‰

---

**åˆ›å»ºæ—¶é—´**: 2025-11-15
**ç‰ˆæœ¬**: v1.0.0
**ä½œè€…**: XiangYuPai Backend Team
